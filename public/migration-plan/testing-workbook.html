<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Yarny React Migration - Testing Workbook</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="/global.css">
  <link rel="stylesheet" href="/docs.css">
  <link rel="stylesheet" href="/footer.css">
  <style>
    /* Keep content styling unchanged */
    .workbook-intro {
      background: rgba(31, 41, 55, 0.95);
      backdrop-filter: blur(10px);
      border-radius: var(--radius-lg);
      padding: var(--space-4xl);
      margin-bottom: var(--space-3xl);
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3), 0 10px 10px -5px rgba(0, 0, 0, 0.2);
    }
    
    .workbook-intro h1 {
      color: var(--color-white);
      font-size: 2.5rem;
      margin-bottom: var(--space-md);
      font-weight: var(--font-weight-bold);
    }
    
    .workbook-intro p {
      color: rgba(255, 255, 255, 0.9);
      font-size: 1.1rem;
      line-height: 1.6;
      margin-bottom: var(--space-md);
    }
    
    .test-section {
      background: rgba(31, 41, 55, 0.6);
      border-radius: var(--radius-lg);
      padding: var(--space-4xl);
      margin-bottom: var(--space-4xl);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .test-section h2 {
      color: var(--color-primary);
      font-size: 1.8rem;
      margin-bottom: var(--space-lg);
      display: flex;
      align-items: center;
      gap: var(--space-md);
    }
    
    .test-section h3 {
      color: rgba(255, 255, 255, 0.9);
      font-size: 1.3rem;
      margin-top: var(--space-3xl);
      margin-bottom: var(--space-md);
    }
    
    .test-item {
      background: rgba(31, 41, 55, 0.4);
      border-left: 4px solid var(--color-primary);
      padding: var(--space-xl);
      margin-bottom: var(--space-lg);
      border-radius: var(--radius-md);
    }
    
    .test-item h4 {
      color: rgba(255, 255, 255, 0.95);
      font-size: 1.1rem;
      margin-bottom: var(--space-sm);
      display: flex;
      align-items: center;
      gap: var(--space-sm);
    }
    
    .test-item p {
      color: rgba(255, 255, 255, 0.7);
      margin-bottom: var(--space-md);
      line-height: 1.6;
    }
    
    .test-steps {
      background: rgba(0, 0, 0, 0.2);
      padding: var(--space-lg);
      border-radius: var(--radius-md);
      margin-top: var(--space-md);
    }
    
    .test-steps ol {
      margin: 0;
      padding-left: var(--space-xl);
      color: rgba(255, 255, 255, 0.8);
    }
    
    .test-steps li {
      margin-bottom: var(--space-sm);
      line-height: 1.6;
    }
    
    .checkbox-container {
      display: flex;
      align-items: flex-start;
      gap: var(--space-md);
      margin-top: var(--space-md);
    }
    
    .checkbox-container input[type="checkbox"] {
      margin-top: 4px;
      width: 20px;
      height: 20px;
      cursor: pointer;
      flex-shrink: 0;
    }
    
    .checkbox-container label {
      color: rgba(255, 255, 255, 0.7);
      cursor: pointer;
      flex: 1;
    }
    
    .status-badge {
      display: inline-block;
      padding: 4px 12px;
      border-radius: var(--radius-full);
      font-size: 0.85rem;
      font-weight: var(--font-weight-semibold);
      margin-left: var(--space-sm);
    }
    
    .status-pass {
      background: rgba(16, 185, 129, 0.2);
      color: var(--color-primary);
      border: 1px solid var(--color-primary);
    }
    
    .status-fail {
      background: rgba(239, 68, 68, 0.2);
      color: #EF4444;
      border: 1px solid #EF4444;
    }
    
    .status-skip {
      background: rgba(156, 163, 175, 0.2);
      color: #9CA3AF;
      border: 1px solid #9CA3AF;
    }
    
    .note-box {
      background: rgba(254, 243, 199, 0.1);
      border-left: 4px solid #F59E0B;
      padding: var(--space-lg);
      margin: var(--space-lg) 0;
      border-radius: var(--radius-md);
    }
    
    .note-box p {
      color: rgba(255, 255, 255, 0.9);
      margin: 0;
    }
    
    .note-box strong {
      color: #F59E0B;
    }
    
    .summary-section {
      background: rgba(16, 185, 129, 0.1);
      border: 2px solid var(--color-primary);
      border-radius: var(--radius-lg);
      padding: var(--space-4xl);
      margin-top: var(--space-6xl);
      text-align: center;
    }
    
    .summary-section h2 {
      color: var(--color-primary);
      margin-bottom: var(--space-xl);
    }
    
    .summary-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: var(--space-xl);
      margin-top: var(--space-2xl);
    }
    
    .stat-box {
      background: rgba(31, 41, 55, 0.6);
      padding: var(--space-xl);
      border-radius: var(--radius-md);
    }
    
    .stat-box .stat-number {
      font-size: 2rem;
      font-weight: var(--font-weight-bold);
      color: var(--color-primary);
    }
    
    .stat-box .stat-label {
      color: rgba(255, 255, 255, 0.7);
      margin-top: var(--space-sm);
    }
  </style>
</head>
<body>
  <div class="docs-container">
    <header class="docs-header">
      <div class="docs-header-content">
        <div>
          <h1>Yarny</h1>
          <p class="docs-subtitle">React Migration - Testing Workbook</p>
        </div>
        <nav class="docs-nav">
          <a href="/stories.html" id="storiesNavLink" class="btn-secondary" style="display: none;">My Stories</a>
          <a href="/docs.html" class="btn-secondary">Docs</a>
          <a href="/migration-plan" class="btn-secondary">Migration Plan</a>
          <a href="/" id="loginNavLink" class="btn-secondary">Back to Login</a>
        </nav>
      </div>
    </header>

    <main class="docs-main">
      <div class="sidebar-backdrop"></div>
      <aside class="docs-sidebar">
        <nav class="sidebar-nav">
          <ul class="sidebar-nav-list">
            <li><a href="#intro" class="nav-link">Introduction</a></li>
            <li><a href="#section-1" class="nav-link">Section 1: Editor - Visual & IME</a></li>
            <li><a href="#section-2" class="nav-link">Section 2: Drag & Drop Visual</a></li>
            <li><a href="#section-3" class="nav-link">Section 3: Classic UX Anchors</a></li>
            <li><a href="#section-4" class="nav-link">Section 4: Notes Drag & Drop</a></li>
            <li><a href="#section-5" class="nav-link">Section 5: Export Functionality</a></li>
            <li><a href="#section-6" class="nav-link">Section 6: Google Drive Integration & Sync</a></li>
            <li><a href="#section-7" class="nav-link">Section 7: UI/UX Elements</a></li>
            <li><a href="#section-8" class="nav-link">Section 8: Performance & Edge Cases</a></li>
            <li><a href="#summary" class="nav-link">Testing Summary</a></li>
          </ul>
        </nav>
      </aside>

      <div class="docs-content">
        <div class="workbook-intro" id="intro">
          <h1>Yarny React Migration - Manual Testing Workbook</h1>
          <p>This workbook guides you through the <strong>manual testing</strong> required after the React migration is complete. Most functional tests are now automated and run continuously in CI/CD.</p>
          <p><strong>Note:</strong> This workbook focuses on tests that require human judgment, visual verification, or subjective evaluation. Automated tests cover functional correctness, data persistence, calculations, and performance metrics.</p>
          <div class="note-box" style="margin-top: var(--space-lg);">
            <p><strong>Automated Testing:</strong> Functional tests (authentication, CRUD operations, data persistence, calculations, search, export, conflict resolution, etc.) are automated using Playwright and React Testing Library. These tests run on every PR and deployment.</p>
          </div>
          <div class="note-box" style="margin-top: var(--space-lg);">
            <p><strong>Test Corpus:</strong> For comprehensive testing, use the "Yarny Test Corpus" folder in Google Drive, which contains three project sizes (small, medium, large) with sample data. Start with the small project for basic tests, then use medium and large projects for performance and edge case testing.</p>
          </div>
        </div>

        <!-- Note: Sections 1 and 2 (Authentication, Story Management) are fully automated -->

        <!-- Section 1: Editor - Visual & IME Testing -->
        <div class="test-section" id="section-1">
          <h2><i class="material-icons">edit</i> Section 1: Editor - Visual & IME Testing</h2>
          <p style="color: rgba(255, 255, 255, 0.7); margin-bottom: var(--space-lg);">These tests require visual verification or human judgment. Functional editor tests (open snippet, edit content, auto-save, word count) are automated.</p>
        
        <div class="test-item">
          <h4>Test 1.1: Plain Text Only (No Rich Formatting) - Visual Verification</h4>
          <p>Verify that the editor only supports plain text (no bold, italic, colors, etc.) and preserves paragraph/line breaks correctly.</p>
          <div class="test-steps">
            <ol>
              <li>Type some text in the editor</li>
              <li>Try to make text bold (Ctrl+B or Cmd+B) - it should NOT work</li>
              <li>Try to make text italic (Ctrl+I or Cmd+I) - it should NOT work</li>
              <li>Paste rich text from another document</li>
              <li>Verify the formatting is stripped and only plain text remains</li>
              <li>Test paragraph breaks: Press Enter twice to create a paragraph break</li>
              <li>Verify paragraph breaks (double Enter) create proper spacing between paragraphs</li>
              <li>Test soft line breaks: Press Shift+Enter to create a line break within a paragraph</li>
              <li>Verify single line breaks (Shift+Enter) work correctly without creating new paragraphs</li>
              <li>Save the snippet and open it in Google Docs</li>
              <li>Verify paragraph breaks and line breaks are preserved correctly in Google Docs</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-1-1" name="test-1-1">
            <label for="test-1-1">Editor only supports plain text and preserves paragraph/line breaks correctly</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 1.2: IME Composition Handling (Japanese/Chinese/Korean Input)</h4>
          <p>Verify that the editor handles IME (Input Method Editor) composition correctly for Japanese, Chinese, and Korean text input.</p>
          <div class="test-steps">
            <ol>
              <li>Enable Japanese IME on your computer (or use browser dev tools to simulate)</li>
              <li>Open a snippet in the Yarny editor</li>
              <li>Start typing in Japanese (e.g., "こんにちは" - konnichiwa)</li>
              <li>While composing (before pressing Enter to confirm), verify word count does NOT update prematurely</li>
              <li>Complete the IME composition (press Enter to confirm)</li>
              <li>Verify word count updates only after composition ends</li>
              <li>Verify save debouncing respects composition (doesn't save during composition)</li>
              <li>Repeat with Chinese text (e.g., "你好" - nǐ hǎo)</li>
              <li>Repeat with Korean text (e.g., "안녕하세요" - annyeonghaseyo)</li>
              <li>Verify all IME compositions work correctly</li>
              <li>Save the snippet and verify the text is preserved correctly</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-1-2" name="test-1-2">
            <label for="test-1-2">IME composition handling works correctly for Japanese/Chinese/Korean input</label>
          </div>
        </div>

      </div>

        <!-- Section 2: Drag & Drop Visual Testing -->
        <div class="test-section" id="section-2">
          <h2><i class="material-icons">folder</i> Section 2: Drag & Drop Visual Testing</h2>
          <p style="color: rgba(255, 255, 255, 0.7); margin-bottom: var(--space-lg);">These tests require visual verification of drag & drop feedback. Functional drag & drop operations (create, rename, delete chapters/snippets) are automated.</p>
        
        <div class="test-item">
          <h4>Test 2.1: Drag & Drop Reorder Chapters - Visual Feedback</h4>
          <p>Verify that you can reorder chapters by dragging and dropping.</p>
          <div class="test-steps">
            <ol>
              <li>Click and hold on a chapter in the left sidebar</li>
              <li>Drag it up or down to a new position</li>
              <li>Release to drop it</li>
              <li>Verify the chapter moves to the new position</li>
              <li>Refresh the page</li>
              <li>Verify the chapter order is preserved</li>
              <li>Verify the order is saved in Google Drive</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-2-1" name="test-2-1">
            <label for="test-2-1">I can reorder chapters by dragging and dropping</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 2.2: Drag & Drop Reorder Snippets - Visual Feedback</h4>
          <p>Verify that you can reorder snippets within a chapter by dragging and dropping.</p>
          <div class="test-steps">
            <ol>
              <li>Click and hold on a snippet in the left sidebar</li>
              <li>Drag it up or down within the same chapter</li>
              <li>Release to drop it</li>
              <li>Verify the snippet moves to the new position</li>
              <li>Refresh the page</li>
              <li>Verify the snippet order is preserved</li>
              <li>Verify the order is saved in Google Drive</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-2-2" name="test-2-2">
            <label for="test-2-2">I can reorder snippets by dragging and dropping</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 2.3: Drag & Drop Move Snippet Between Chapters - Visual Feedback</h4>
          <p>Verify that you can move a snippet from one chapter to another by dragging and dropping.</p>
          <div class="test-steps">
            <ol>
              <li>Click and hold on a snippet</li>
              <li>Drag it to a different chapter</li>
              <li>Release to drop it</li>
              <li>Verify the snippet moves to the new chapter</li>
              <li>Verify the snippet disappears from the old chapter</li>
              <li>Refresh the page</li>
              <li>Verify the snippet is still in the new chapter</li>
              <li>Verify the Google Doc is moved to the new chapter folder in Google Drive</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-2-3" name="test-2-3">
            <label for="test-2-3">I can move snippets between chapters by dragging and dropping</label>
          </div>
        </div>

      </div>

        <!-- Note: Sections 5 and 6 (Color Coding, Search) are fully automated -->

        <!-- Section 3: Classic UX Anchors - Visual Parity -->
        <div class="test-section" id="section-3">
          <h2><i class="material-icons">track_changes</i> Section 3: Classic UX Anchors - Visual Parity</h2>
          <p style="color: rgba(255, 255, 255, 0.7); margin-bottom: var(--space-lg);">These tests require visual comparison with the original app to verify design parity. Functional goal tests (set goal, calculations, updates) are automated.</p>
        
        <div class="test-item">
          <h4>Test 3.1: Goal Meter - Visual Parity Check</h4>
          <p>Verify that the goal meter in the left sidebar displays correctly.</p>
          <div class="test-steps">
            <ol>
              <li>In the editor, look at the left sidebar</li>
              <li>Find the goal meter (should show "X / Y" where X is current word count and Y is goal)</li>
              <li>Verify it shows "0 / 3,000" or similar if a goal is set</li>
              <li>Verify a progress bar shows completion percentage</li>
              <li>Click on the goal meter</li>
              <li>Verify the goal panel modal opens</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-3-1" name="test-3-1">
            <label for="test-3-1">Goal meter displays correctly and is clickable</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 3.2: "Today • N" Chip - Visual Parity Check</h4>
          <p>Verify that the "Today • N" chip displays daily word count correctly.</p>
          <div class="test-steps">
            <ol>
              <li>In the editor, look at the left sidebar below the goal meter</li>
              <li>Find the "Today • N" chip (where N is today's word count)</li>
              <li>Verify it shows "Today • 0" or the actual daily word count</li>
              <li>Write some text in a snippet</li>
              <li>Verify the "Today • N" number updates</li>
              <li>Verify a progress bar shows daily progress (if daily target is set)</li>
              <li>Click on the chip</li>
              <li>Verify the goal panel modal opens</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-3-2" name="test-3-2">
            <label for="test-3-2">"Today • N" chip displays and updates correctly</label>
          </div>
        </div>

      </div>

        <!-- Section 4: Notes Drag & Drop Visual Testing -->
        <div class="test-section" id="section-4">
          <h2><i class="material-icons">note</i> Section 4: Notes Drag & Drop Visual Testing</h2>
          <p style="color: rgba(255, 255, 255, 0.7); margin-bottom: var(--space-lg);">This test requires visual verification of drag & drop feedback. Functional notes tests (create, edit, rename, delete) are automated.</p>
        
        <div class="test-item">
          <h4>Test 4.1: Reorder Notes (Drag & Drop) - Visual Feedback</h4>
          <p>Verify that you can reorder notes by dragging and dropping.</p>
          <div class="test-steps">
            <ol>
              <li>Click and hold on a note in the right sidebar</li>
              <li>Drag it up or down to a new position</li>
              <li>Release to drop it</li>
              <li>Verify the note moves to the new position</li>
              <li>Refresh the page</li>
              <li>Verify the note order is preserved</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-4-1" name="test-4-1">
            <label for="test-4-1">I can reorder notes by dragging and dropping</label>
          </div>
        </div>
      </div>

        <!-- Section 5: Export Functionality -->
        <div class="test-section" id="section-5">
          <h2><i class="material-icons">file_download</i> Section 5: Export Functionality</h2>
        
        <div class="test-item">
          <h4>Test 5.1: Export All Chapters</h4>
          <p>Verify that you can export all chapters as a single Google Doc.</p>
          <div class="test-steps">
            <ol>
              <li>In the editor, look for an "Export" button or menu</li>
              <li>Click it and select "Export All Chapters"</li>
              <li>Enter a filename for the export</li>
              <li>Optionally choose to include snippet names</li>
              <li>Click "Export"</li>
              <li>Verify a new Google Doc is created in the story folder in Google Drive</li>
              <li>Open the exported Google Doc</li>
              <li>Verify all chapters and snippets are included in order</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-5-1" name="test-5-1">
            <label for="test-5-1">I can export all chapters as a Google Doc</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 5.2: Export Outline</h4>
          <p>Verify that you can export an outline (chapter and snippet titles with descriptions).</p>
          <div class="test-steps">
            <ol>
              <li>Click "Export" and select "Export Outline"</li>
              <li>Enter a filename for the export</li>
              <li>Click "Export"</li>
              <li>Verify a new Google Doc is created in the story folder</li>
              <li>Open the exported Google Doc</li>
              <li>Verify it contains chapter titles, snippet titles, and descriptions</li>
              <li>Verify it does NOT contain snippet body content</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-5-2" name="test-5-2">
            <label for="test-5-2">I can export an outline with titles and descriptions</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 5.3: Export All People</h4>
          <p>Verify that you can export all People notes as a single Google Doc.</p>
          <div class="test-steps">
            <ol>
              <li>Click "Export" and select "Export All People"</li>
              <li>Enter a filename for the export</li>
              <li>Click "Export"</li>
              <li>Verify a new Google Doc is created in the story folder</li>
              <li>Open the exported Google Doc</li>
              <li>Verify it contains all People notes with their content</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-5-3" name="test-5-3">
            <label for="test-5-3">I can export all People notes</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 5.4: Export All Places</h4>
          <p>Verify that you can export all Places notes as a single Google Doc.</p>
          <div class="test-steps">
            <ol>
              <li>Click "Export" and select "Export All Places"</li>
              <li>Enter a filename for the export</li>
              <li>Click "Export"</li>
              <li>Verify a new Google Doc is created in the story folder</li>
              <li>Open the exported Google Doc</li>
              <li>Verify it contains all Places notes with their content</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-5-4" name="test-5-4">
            <label for="test-5-4">I can export all Places notes</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 5.5: Export All Things</h4>
          <p>Verify that you can export all Things notes as a single Google Doc.</p>
          <div class="test-steps">
            <ol>
              <li>Click "Export" and select "Export All Things"</li>
              <li>Enter a filename for the export</li>
              <li>Click "Export"</li>
              <li>Verify a new Google Doc is created in the story folder</li>
              <li>Open the exported Google Doc</li>
              <li>Verify it contains all Things notes with their content</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-5-5" name="test-5-5">
            <label for="test-5-5">I can export all Things notes</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 5.6: Export Large Chapter (Chunked Writes)</h4>
          <p>Verify that exporting a very large chapter (50+ snippets) uses chunked writes to handle Google Docs API body size limits.</p>
          <div class="test-steps">
            <ol>
              <li>Open a story with a very large chapter (50+ snippets) - use test-large project if available</li>
              <li>Click "Export" and select "Export All Chapters" (or export just the large chapter)</li>
              <li>Enter a filename for the export</li>
              <li>Click "Export"</li>
              <li>Verify a progress indicator appears during export (if chunked writes are used)</li>
              <li>Verify the export completes successfully without errors</li>
              <li>Verify all snippets are included in the export (no truncation)</li>
              <li>Open the exported Google Doc</li>
              <li>Verify all snippets are in the correct order</li>
              <li>Verify the export order is preserved across chunks (if chunked)</li>
              <li>Verify the exported document is complete and readable</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-5-6" name="test-5-6">
            <label for="test-5-6">Large chapter export uses chunked writes correctly</label>
          </div>
        </div>
      </div>

        <!-- Section 6: Google Drive Integration & Sync -->
        <div class="test-section" id="section-6">
          <h2><i class="material-icons">cloud</i> Section 6: Google Drive Integration & Sync</h2>
        
        <div class="test-item">
          <h4>Test 6.1: Files Created in Google Drive</h4>
          <p>Verify that all created items (stories, chapters, snippets, notes) appear in Google Drive.</p>
          <div class="test-steps">
            <ol>
              <li>Create a new story in Yarny</li>
              <li>Open Google Drive in another tab</li>
              <li>Navigate to "Yarny Stories" folder</li>
              <li>Verify the story folder exists</li>
              <li>Create a chapter and snippet in Yarny</li>
              <li>Refresh Google Drive</li>
              <li>Verify the chapter folder and snippet Google Doc exist in the story folder</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-6-1" name="test-6-1">
            <label for="test-6-1">All created items appear in Google Drive</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 6.2: Changes Saved to Google Drive</h4>
          <p>Verify that edits made in Yarny are saved to Google Drive files.</p>
          <div class="test-steps">
            <ol>
              <li>Edit a snippet in Yarny</li>
              <li>Wait for auto-save to complete (check save status)</li>
              <li>Open the snippet's Google Doc in Google Drive</li>
              <li>Verify your changes appear in the Google Doc</li>
              <li>Edit a note in Yarny</li>
              <li>Open the note's text file in Google Drive</li>
              <li>Verify your changes appear in the text file</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-6-2" name="test-6-2">
            <label for="test-6-2">Changes are saved to Google Drive files</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 6.3: Round-Trip Editing (Yarny → Google Docs → Yarny)</h4>
          <p>Verify that you can edit in Google Docs and see changes in Yarny with no format loss (plain text only).</p>
          <div class="test-steps">
            <ol>
              <li>Edit a snippet in Yarny with paragraph breaks (double Enter) and line breaks (Shift+Enter)</li>
              <li>Save the snippet in Yarny</li>
              <li>Open the same snippet's Google Doc in Google Docs (another tab)</li>
              <li>Verify the content matches exactly (paragraph breaks and line breaks preserved)</li>
              <li>Make changes in Google Docs (add text, modify existing text)</li>
              <li>Save in Google Docs</li>
              <li>In Yarny, switch to a different snippet (or close and reopen Yarny)</li>
              <li>Switch back to the original snippet</li>
              <li>Verify Yarny detects the external changes (may show conflict resolution or reconciliation)</li>
              <li>Verify you can see the changes from Google Docs</li>
              <li>Verify paragraph breaks and line breaks are still preserved correctly</li>
              <li>Verify no formatting (bold, italic, etc.) was introduced</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-6-3" name="test-6-3">
            <label for="test-6-3">I can edit in Google Docs and see changes in Yarny with no format loss</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 6.3a: Cross-Edit Testing (Yarny Idle → Google Docs Edit → Yarny)</h4>
          <p>Verify that Yarny detects changes made in Google Docs while Yarny is idle (not actively editing the snippet).</p>
          <div class="test-steps">
            <ol>
              <li>Open a snippet in Yarny (make it the active snippet)</li>
              <li>Switch to a different snippet in Yarny (make the first snippet idle, not actively being edited)</li>
              <li>In another tab, open the first snippet's Google Doc in Google Docs</li>
              <li>Make edits in Google Docs</li>
              <li>Save in Google Docs</li>
              <li>Return to Yarny and switch back to the first snippet</li>
              <li>Verify Yarny detects the external changes</li>
              <li>Verify a conflict resolution modal or reconciliation notification appears</li>
              <li>Verify you can see the changes from Google Docs</li>
              <li>Verify you can choose to keep Yarny version or use Google Docs version</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-6-3a" name="test-6-3a">
            <label for="test-6-3a">Yarny detects changes made in Google Docs while snippet is idle</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 6.4: Conflict Detection</h4>
          <p>Verify that Yarny detects conflicts when both Yarny and Google Docs are edited (but NOT while actively editing in Yarny).</p>
          <div class="test-steps">
            <ol>
              <li>Edit a snippet in Yarny and save</li>
              <li>Switch to a different snippet in Yarny (make the first snippet idle)</li>
              <li>Open the first snippet's Google Doc in Google Docs (another tab)</li>
              <li>Make different changes in Google Docs</li>
              <li>Save in Google Docs</li>
              <li>In Yarny, switch back to the original snippet</li>
              <li>Verify a conflict resolution modal appears (conflicts are detected when switching snippets, not while actively editing)</li>
              <li>Verify you can see both versions (Yarny version vs Google Docs version)</li>
              <li>Verify the modal shows timestamps for both versions</li>
              <li>Verify you can compare the differences</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-6-4" name="test-6-4">
            <label for="test-6-4">Conflict detection works when both are edited (detected on snippet switch)</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 6.5: Conflict Resolution - Keep Yarny Version</h4>
          <p>Verify that you can resolve conflicts by keeping the Yarny version.</p>
          <div class="test-steps">
            <ol>
              <li>Trigger a conflict (see Test 6.4)</li>
              <li>In the conflict resolution modal, choose "Keep Yarny Version"</li>
              <li>Verify the Yarny version is kept</li>
              <li>Verify the Google Doc is updated with the Yarny version</li>
              <li>Open the Google Doc in Google Docs</li>
              <li>Verify it matches the Yarny version</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-6-5" name="test-6-5">
            <label for="test-6-5">I can resolve conflicts by keeping Yarny version</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 6.6: Conflict Resolution - Use Google Docs Version</h4>
          <p>Verify that you can resolve conflicts by using the Google Docs version.</p>
          <div class="test-steps">
            <ol>
              <li>Trigger a conflict (see Test 6.4)</li>
              <li>In the conflict resolution modal, choose "Use Google Docs Version"</li>
              <li>Verify the Google Docs version replaces the Yarny content</li>
              <li>Verify the editor shows the Google Docs content</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-6-6" name="test-6-6">
            <label for="test-6-6">I can resolve conflicts by using Google Docs version</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 6.7: Reconciliation on Window Focus</h4>
          <p>Verify that Yarny checks for external changes when the window regains focus.</p>
          <div class="test-steps">
            <ol>
              <li>Open a snippet in Yarny</li>
              <li>Switch to another browser tab</li>
              <li>Edit the snippet's Google Doc in Google Docs</li>
              <li>Save in Google Docs</li>
              <li>Switch back to the Yarny tab (window regains focus)</li>
              <li>Verify Yarny detects the external changes</li>
              <li>Verify a reconciliation notification appears (or conflict modal if content differs)</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-6-7" name="test-6-7">
            <label for="test-6-7">Yarny checks for external changes on window focus</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 6.8: Comments/Tracked Changes Warning</h4>
          <p>Verify that Yarny warns about comments or tracked changes in Google Docs.</p>
          <div class="test-steps">
            <ol>
              <li>Open a snippet's Google Doc in Google Docs</li>
              <li>Add a comment to the document</li>
              <li>Save in Google Docs</li>
              <li>In Yarny, try to save the snippet (or switch snippets)</li>
              <li>Verify a warning modal appears about comments/tracked changes</li>
              <li>Verify you can acknowledge the warning and proceed</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-6-8" name="test-6-8">
            <label for="test-6-8">Yarny warns about comments/tracked changes in Google Docs</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 6.9: Cross-Tab Yarny Conflicts</h4>
          <p>Verify that Yarny detects and prevents conflicts when the same snippet is edited in multiple Yarny tabs.</p>
          <div class="test-steps">
            <ol>
              <li>Open Yarny in two browser tabs (Tab 1 and Tab 2)</li>
              <li>In Tab 1, open a snippet and start editing</li>
              <li>In Tab 2, try to open the same snippet</li>
              <li>Verify Tab 2 shows "Editing in another tab" message or read-only indicator</li>
              <li>Verify Tab 2 is read-only (cannot edit) while Tab 1 is editing</li>
              <li>Save the snippet in Tab 1</li>
              <li>Switch to Tab 2</li>
              <li>Verify Tab 2 updates with the latest content from Tab 1</li>
              <li>Close Tab 1</li>
              <li>Verify Tab 2 regains edit capability (no longer read-only)</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-6-9" name="test-6-9">
            <label for="test-6-9">Cross-tab conflict detection prevents simultaneous editing</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 6.10: Format Normalization (Line Endings, NBSPs, Trailing Spaces)</h4>
          <p>Verify that Yarny normalizes text format to match Google Docs behavior (mixed line endings, non-breaking spaces, trailing spaces).</p>
          <div class="test-steps">
            <ol>
              <li>Create a snippet with mixed line endings: some lines ending with `\n`, some with `\r\n`, some with `\r`</li>
              <li>Add non-breaking spaces (NBSP) in the text</li>
              <li>Add trailing spaces at the end of some lines</li>
              <li>Save the snippet in Yarny</li>
              <li>Open the Google Doc in Google Drive</li>
              <li>Verify all line endings are normalized to `\n` (no `\r\n` or `\r`)</li>
              <li>Verify NBSPs are normalized to regular spaces</li>
              <li>Verify trailing spaces are handled correctly (may be collapsed by Google Docs)</li>
              <li>Edit the snippet in Google Docs and add more mixed formatting</li>
              <li>Switch snippets in Yarny and switch back</li>
              <li>Verify the text is normalized correctly after round-trip</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-6-10" name="test-6-10">
            <label for="test-6-10">Format normalization works correctly (line endings, NBSPs, trailing spaces)</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 6.11: Visibility-Based Request Gating</h4>
          <p>Verify that Yarny only makes background requests when the browser tab is visible (prevents Drive quota exhaustion).</p>
          <div class="test-steps">
            <ol>
              <li>Open Yarny in multiple browser tabs</li>
              <li>Open a story with many snippets in Tab 1</li>
              <li>Switch to Tab 2 (Tab 1 becomes hidden)</li>
              <li>Check browser network tab or console</li>
              <li>Verify Tab 1 stops making background prefetch requests when hidden</li>
              <li>Switch back to Tab 1 (tab becomes visible)</li>
              <li>Verify background prefetch requests resume in Tab 1</li>
              <li>Verify only the visible tab makes background requests</li>
              <li>Test with mutations (save, delete, rename) in hidden tab</li>
              <li>Verify mutations also respect visibility gating (may be queued or delayed)</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-6-11" name="test-6-11">
            <label for="test-6-11">Visibility-based request gating prevents quota exhaustion</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 6.12: Drive API Rate Limiting (429 Errors)</h4>
          <p>Verify that Yarny handles Drive API rate limit errors (429) gracefully with exponential backoff.</p>
          <div class="test-steps">
            <ol>
              <li>Trigger rate limiting by making rapid requests (or simulate 429 error)</li>
              <li>Verify Yarny detects the 429 rate limit error</li>
              <li>Verify exponential backoff with jitter is applied (delays between retries: 1s, 2s, 4s, etc.)</li>
              <li>Verify retry only happens when tab is visible (background tabs don't retry)</li>
              <li>Verify a clear error message is displayed to the user</li>
              <li>Verify automatic retry happens after backoff delay</li>
              <li>Verify no infinite retry loops (max 3 retries)</li>
              <li>After successful retry, verify the operation completes</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-6-12" name="test-6-12">
            <label for="test-6-12">Drive API rate limiting is handled gracefully with exponential backoff</label>
          </div>
        </div>
      </div>

        <!-- Section 7: UI/UX Elements -->
        <div class="test-section" id="section-7">
          <h2><i class="material-icons">design_services</i> Section 7: UI/UX Elements</h2>
        
        <div class="test-item">
          <h4>Test 7.1: Classic UX Anchors - Goal Meter</h4>
          <p>Verify that the goal meter looks and behaves identically to the original app.</p>
          <div class="test-steps">
            <ol>
              <li>Compare the goal meter in the left sidebar with the original app (if available)</li>
              <li>Verify it shows "X / Y" format (e.g., "0 / 3,000")</li>
              <li>Verify the progress bar styling matches (colors, height, border radius)</li>
              <li>Verify clicking it opens the goal panel</li>
              <li>Verify it updates in real-time as you write</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-7-1" name="test-7-1">
            <label for="test-7-1">Goal meter looks and behaves identically to original</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 7.2: Classic UX Anchors - "Today • N" Chip</h4>
          <p>Verify that the "Today • N" chip looks and behaves identically to the original app.</p>
          <div class="test-steps">
            <ol>
              <li>Compare the "Today • N" chip with the original app (if available)</li>
              <li>Verify it shows "Today • N" format with number formatting (commas for large numbers)</li>
              <li>Verify the progress bar styling matches (2px height, subtle background)</li>
              <li>Verify color logic (green/red in strict mode, primary color otherwise)</li>
              <li>Verify clicking it opens the goal panel</li>
              <li>Verify it always shows (even when no goal set, shows "—")</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-7-2" name="test-7-2">
            <label for="test-7-2">"Today • N" chip looks and behaves identically to original</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 7.3: Classic UX Anchors - Footer Word/Character Counts</h4>
          <p>Verify that the footer word/character counts look and behave identically to the original app.</p>
          <div class="test-steps">
            <ol>
              <li>Compare the footer counts with the original app (if available)</li>
              <li>Verify it shows "Words: N — Characters: N" format</li>
              <li>Verify the font size, color, and spacing match</li>
              <li>Verify it updates in real-time as you type</li>
              <li>Verify it shows counts for active snippet only</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-7-3" name="test-7-3">
            <label for="test-7-3">Footer word/character counts look and behave identically to original</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 7.4: Modals - Open and Close</h4>
          <p>Verify that all modals open and close correctly.</p>
          <div class="test-steps">
            <ol>
              <li>Test opening each modal: Story Info, Export, Description Edit, Goal Panel, Rename, Delete, Conflict Resolution, Comments Warning</li>
              <li>Verify each modal opens when triggered</li>
              <li>Verify you can close modals by: clicking X button, clicking outside modal, pressing Escape key</li>
              <li>Verify modals don't overlap or break layout</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-7-4" name="test-7-4">
            <label for="test-7-4">All modals open and close correctly</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 7.5: Context Menus</h4>
          <p>Verify that right-click context menus work correctly.</p>
          <div class="test-steps">
            <ol>
              <li>Right-click on a chapter in the left sidebar</li>
              <li>Verify a context menu appears with options (Rename, Delete, Change Color, etc.)</li>
              <li>Right-click on a snippet</li>
              <li>Verify a context menu appears with options</li>
              <li>Click on a menu option</li>
              <li>Verify the action is performed</li>
              <li>Click outside the menu</li>
              <li>Verify the menu closes</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-7-5" name="test-7-5">
            <label for="test-7-5">Context menus work correctly</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 7.6: Mobile Device Warning</h4>
          <p>Verify that mobile devices show a warning message.</p>
          <div class="test-steps">
            <ol>
              <li>Access Yarny from a mobile device (or use browser dev tools to simulate mobile)</li>
              <li>Verify a warning message appears</li>
              <li>Verify the message says to use a computer</li>
              <li>Verify you can navigate back to stories from the warning</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-7-6" name="test-7-6">
            <label for="test-7-6">Mobile devices show warning message</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 7.7: Loading States</h4>
          <p>Verify that loading indicators appear during data fetching.</p>
          <div class="test-steps">
            <ol>
              <li>Open a story with many snippets</li>
              <li>Verify loading indicators appear while snippets load</li>
              <li>Switch between snippets</li>
              <li>Verify loading states appear if content isn't cached</li>
              <li>Verify the UI doesn't freeze during loading</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-7-7" name="test-7-7">
            <label for="test-7-7">Loading indicators appear during data fetching</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 7.8: Error Messages</h4>
          <p>Verify that error messages are clear and helpful.</p>
          <div class="test-steps">
            <ol>
              <li>Try to perform an action that might fail (e.g., save with network disconnected)</li>
              <li>Verify an error message appears</li>
              <li>Verify the error message is clear and explains what went wrong</li>
              <li>Verify you can retry the action if applicable</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-7-8" name="test-7-8">
            <label for="test-7-8">Error messages are clear and helpful</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 7.9: Accessible Focus Rings</h4>
          <p>Verify that focus rings are visible and accessible when navigating with keyboard (especially on dark cards and pale chips).</p>
          <div class="test-steps">
            <ol>
              <li>Use Tab key to navigate through the interface (don't use mouse)</li>
              <li>Navigate to elements in the left sidebar (dark card background)</li>
              <li>Verify focus rings are visible on dark backgrounds (should be lighter color, e.g., primary-light)</li>
              <li>Navigate to elements on pale chip backgrounds</li>
              <li>Verify focus rings are visible on light backgrounds (should be darker color, e.g., primary-dark)</li>
              <li>Navigate through modals and buttons</li>
              <li>Verify all interactive elements show clear focus indicators</li>
              <li>Verify focus rings are 2px solid with 2px offset (accessible standard)</li>
              <li>Test with high contrast mode enabled (if available)</li>
              <li>Verify focus rings remain visible in all contexts</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-7-9" name="test-7-9">
            <label for="test-7-9">Focus rings are visible and accessible on all backgrounds</label>
          </div>
        </div>
      </div>

        <!-- Section 8: Performance & Edge Cases -->
        <div class="test-section" id="section-8">
          <h2><i class="material-icons">speed</i> Section 8: Performance & Edge Cases</h2>
        
        <div class="test-item">
          <h4>Test 8.1: Large Story Performance</h4>
          <p>Verify that the app performs well with large stories (many chapters and snippets).</p>
          <div class="test-steps">
            <ol>
              <li>Open a story with 25+ chapters and 200+ snippets (if available)</li>
              <li>Verify the app loads in a reasonable time (< 5 seconds)</li>
              <li>Scroll through the chapter/snippet list</li>
              <li>Verify scrolling is smooth (no lag)</li>
              <li>Switch between snippets</li>
              <li>Verify snippet switching is responsive</li>
              <li>Verify the UI doesn't freeze or become unresponsive</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-8-1" name="test-8-1">
            <label for="test-8-1">App performs well with large stories</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 8.2: Lazy Loading</h4>
          <p>Verify that snippet content loads on demand (lazy loading).</p>
          <div class="test-steps">
            <ol>
              <li>Open a story with many snippets</li>
              <li>Verify the active snippet loads immediately</li>
              <li>Verify other snippets load in the background (check network tab or wait)</li>
              <li>Switch to a different snippet</li>
              <li>Verify it loads quickly (may be from cache if already loaded)</li>
              <li>Verify the UI doesn't block while loading</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-8-2" name="test-8-2">
            <label for="test-8-2">Snippet content loads on demand (lazy loading)</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 8.3: Performance Budget - Time to First Edit (Hot Path)</h4>
          <p>Verify that opening a snippet already in cache and starting to type is fast (≤300 ms from click to first character appearing).</p>
          <div class="test-steps">
            <ol>
              <li>Open a story and load a snippet (content is now cached)</li>
              <li>Switch to a different snippet and back to the first one (ensures it's in cache)</li>
              <li>Click on the snippet to open it in the editor</li>
              <li>Start typing immediately</li>
              <li>Measure time from click to first character appearing (use browser dev tools or stopwatch)</li>
              <li>Verify latency is ≤300 ms (hot path - snippet already in cache)</li>
              <li>Repeat with several different snippets</li>
              <li>Verify all meet the performance budget</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-8-3" name="test-8-3">
            <label for="test-8-3">Time to first edit (hot path) is ≤300 ms</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 8.4: Performance Budget - Time to First Edit (Cold Path)</h4>
          <p>Verify that opening a snippet not yet loaded and starting to type is acceptable (≤1.5 s from click to first character appearing, includes Drive fetch).</p>
          <div class="test-steps">
            <ol>
              <li>Open a story with many snippets</li>
              <li>Find a snippet that hasn't been loaded yet (not in cache)</li>
              <li>Click on the snippet to open it in the editor</li>
              <li>Start typing immediately</li>
              <li>Measure time from click to first character appearing (use browser dev tools or stopwatch)</li>
              <li>Verify latency is ≤1.5 s (cold path - includes Drive fetch)</li>
              <li>Repeat with several different unloaded snippets</li>
              <li>Verify all meet the performance budget</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-8-4" name="test-8-4">
            <label for="test-8-4">Time to first edit (cold path) is ≤1.5 s</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 8.5: Performance Budget - Time to Switch Snippet (Hot Path)</h4>
          <p>Verify that switching to a snippet already in cache is fast (≤300 ms from click to editor ready).</p>
          <div class="test-steps">
            <ol>
              <li>Open a story and load multiple snippets (ensure they're in cache)</li>
              <li>Click on a snippet that's already been loaded</li>
              <li>Measure time from click to editor ready (content visible and editable)</li>
              <li>Verify latency is ≤300 ms (hot path - snippet already in cache)</li>
              <li>Switch between several cached snippets</li>
              <li>Verify all meet the performance budget</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-8-5" name="test-8-5">
            <label for="test-8-5">Time to switch snippet (hot path) is ≤300 ms</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 8.6: Performance Budget - Time to Switch Snippet (Cold Path)</h4>
          <p>Verify that switching to a snippet not yet loaded is acceptable (≤1.5 s from click to editor ready, includes Drive fetch).</p>
          <div class="test-steps">
            <ol>
              <li>Open a story with many snippets</li>
              <li>Find a snippet that hasn't been loaded yet (not in cache)</li>
              <li>Click on the snippet to switch to it</li>
              <li>Measure time from click to editor ready (content visible and editable)</li>
              <li>Verify latency is ≤1.5 s (cold path - includes Drive fetch)</li>
              <li>Switch to several different unloaded snippets</li>
              <li>Verify all meet the performance budget</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-8-6" name="test-8-6">
            <label for="test-8-6">Time to switch snippet (cold path) is ≤1.5 s</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 8.7: Special Characters & Round-Trip Preservation</h4>
          <p>Verify that special characters (quotes, em dashes, etc.) are preserved correctly in round-trips between Yarny and Google Docs.</p>
          <div class="test-steps">
            <ol>
              <li>Type special characters in a snippet: "quotes", 'apostrophes', —em dashes, –en dashes, …ellipses, ©copyright, ®registered, ™trademark</li>
              <li>Save the snippet in Yarny</li>
              <li>Open the Google Doc in Google Drive</li>
              <li>Verify all special characters are preserved exactly</li>
              <li>Edit in Google Docs and add more special characters: curly quotes "like this" and 'this'</li>
              <li>Save in Google Docs</li>
              <li>In Yarny, switch to a different snippet and switch back</li>
              <li>Verify all special characters are preserved in the round-trip</li>
              <li>Edit in Yarny again and add more special characters</li>
              <li>Save and verify in Google Docs that all characters are preserved</li>
              <li>Verify no characters are corrupted or changed during round-trips</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-8-7" name="test-8-7">
            <label for="test-8-7">Special characters are preserved correctly in round-trips</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 8.8: Long Text</h4>
          <p>Verify that the editor handles long text (10,000+ words) without issues.</p>
          <div class="test-steps">
            <ol>
              <li>Open or create a snippet with very long text (10,000+ words)</li>
              <li>Verify the editor displays all text</li>
              <li>Scroll through the text</li>
              <li>Verify scrolling is smooth</li>
              <li>Edit text in the middle</li>
              <li>Verify edits work correctly</li>
              <li>Save the snippet</li>
              <li>Verify it saves successfully</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-8-8" name="test-8-8">
            <label for="test-8-8">Editor handles long text without issues</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 8.9: Empty States</h4>
          <p>Verify that empty states (no stories, no chapters, no snippets) display correctly.</p>
          <div class="test-steps">
            <ol>
              <li>If you have no stories, verify the empty state message appears</li>
              <li>Create a story but don't add chapters</li>
              <li>Verify the editor shows appropriate empty state or message</li>
              <li>Add a chapter but don't add snippets</li>
              <li>Verify appropriate empty state or message appears</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-8-9" name="test-8-9">
            <label for="test-8-9">Empty states display correctly</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 8.10: Offline/Spotty-Network Semantics</h4>
          <p>Verify that the app handles offline and spotty network conditions gracefully with clear user feedback.</p>
          <div class="test-steps">
            <ol>
              <li><strong>Go offline</strong>: Disable network (or use browser dev tools to simulate offline)</li>
              <li>Edit a snippet while offline</li>
              <li>Verify editor remains editable (you can continue typing)</li>
              <li><strong>Offline banner</strong>: Verify offline banner appears at top of editor (non-blocking, dismissible)</li>
              <li>Verify banner message says "You're offline. Changes will be saved when connection is restored."</li>
              <li><strong>Queued save</strong>: Verify save status shows "Queued - will save when online" (no timestamp)</li>
              <li>Make multiple edits while offline</li>
              <li><strong>Reconnect</strong>: Re-enable network</li>
              <li>Verify queued saves automatically retry and complete</li>
              <li><strong>Save status on reconnect</strong>: Verify "Saved at X:XX" appears after successful save</li>
              <li><strong>Stale cache warning</strong>: Go offline again → Wait 5+ minutes → Verify "Using cached data" or "Last synced: X:XX" warning appears</li>
              <li><strong>Network flapping</strong>: Rapidly toggle network on/off multiple times → Verify save queue handles multiple toggles correctly, no data loss</li>
              <li><strong>Retry exhaustion</strong>: Simulate network error with no retries remaining → Verify mutation is queued (not lost), shows queued status</li>
              <li><strong>Multiple queued saves</strong>: Go offline → Make multiple edits to different snippets → Reconnect → Verify all saves complete in order</li>
              <li><strong>Cache staleness</strong>: Load a snippet → Go offline → Wait 10+ minutes → Verify "Last synced: X:XX" appears instead of "Saved at X:XX"</li>
              <li>Verify editor remains editable even with stale cache (but shows warning)</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-8-10" name="test-8-10">
            <label for="test-8-10">App handles offline/spotty-network conditions gracefully with clear feedback</label>
          </div>
        </div>
      </div>

        <!-- Summary Section -->
        <div class="summary-section" id="summary">
          <h2>Testing Summary</h2>
        <p style="color: rgba(255, 255, 255, 0.8); margin-bottom: var(--space-xl);">Use this section to track your overall testing progress.</p>
        
        <div class="summary-stats">
          <div class="stat-box">
            <div class="stat-number" id="totalTests">0</div>
            <div class="stat-label">Total Tests</div>
          </div>
          <div class="stat-box">
            <div class="stat-number" id="completedTests">0</div>
            <div class="stat-label">Completed</div>
          </div>
          <div class="stat-box">
            <div class="stat-number" id="remainingTests">0</div>
            <div class="stat-label">Remaining</div>
          </div>
          <div class="stat-box">
            <div class="stat-number" id="completionPercent">0%</div>
            <div class="stat-label">Completion</div>
          </div>
        </div>
      </div>

        <div class="note-box" style="margin-top: var(--space-4xl);">
          <p><strong>Note:</strong> This testing workbook is designed to be comprehensive. You don't need to complete all tests in one session. Work through them systematically, and note any issues or unexpected behavior you encounter. Report any bugs or problems to the development team.</p>
        </div>
      </div>
    </main>

    <footer class="shared-footer">
      <p>&copy; 2025 Yarny. Your personal writing tool.</p>
      <nav class="shared-footer-nav">
        <a href="/docs.html">User Guide</a>
        <a href="/migration-plan">Migration Plan</a>
        <a href="/migration-plan/testing-workbook">Testing Workbook</a>
      </nav>
    </footer>
  </div>

  <script>
    // Check if user is logged in
    function isTokenExpired(token) {
      if (!token) return true;
      
      try {
        const decoded = atob(token);
        const parts = decoded.split(':');
        
        if (parts.length !== 2) return true;
        
        const timestamp = parseInt(parts[1], 10);
        if (isNaN(timestamp)) return true;
        
        // Check if token is within 48 hours
        const SESSION_DURATION_MS = 48 * 60 * 60 * 1000;
        const now = Date.now();
        const age = now - timestamp;
        
        return age > SESSION_DURATION_MS;
      } catch (error) {
        console.error('Error checking token expiration:', error);
        return true;
      }
    }

    function checkAuthStatus() {
      const authToken = localStorage.getItem('yarny_auth');
      const isLoggedIn = authToken && !isTokenExpired(authToken);
      
      const storiesLink = document.getElementById('storiesNavLink');
      const loginLink = document.getElementById('loginNavLink');
      
      if (isLoggedIn) {
        if (storiesLink) storiesLink.style.display = 'inline-block';
        if (loginLink) loginLink.style.display = 'none';
      } else {
        if (storiesLink) storiesLink.style.display = 'none';
        if (loginLink) loginLink.style.display = 'inline-block';
      }
    }

    // Calculate and update test statistics
    function updateStats() {
      const checkboxes = document.querySelectorAll('input[type="checkbox"]');
      const total = checkboxes.length;
      const completed = Array.from(checkboxes).filter(cb => cb.checked).length;
      const remaining = total - completed;
      const percent = total > 0 ? Math.round((completed / total) * 100) : 0;

      document.getElementById('totalTests').textContent = total;
      document.getElementById('completedTests').textContent = completed;
      document.getElementById('remainingTests').textContent = remaining;
      document.getElementById('completionPercent').textContent = percent + '%';
    }

    // Update stats when checkboxes change
    document.addEventListener('change', function(e) {
      if (e.target.type === 'checkbox') {
        updateStats();
        // Save state to localStorage
        localStorage.setItem('testingWorkbookState', JSON.stringify(
          Array.from(document.querySelectorAll('input[type="checkbox"]')).map(cb => ({
            id: cb.id,
            checked: cb.checked
          }))
        ));
      }
    });

    // Highlight active navigation item based on scroll position
    document.addEventListener('DOMContentLoaded', function() {
      // Check auth status on page load
      checkAuthStatus();
      
      // Load saved checkbox state
      const saved = localStorage.getItem('testingWorkbookState');
      if (saved) {
        try {
          const state = JSON.parse(saved);
          state.forEach(item => {
            const checkbox = document.getElementById(item.id);
            if (checkbox) {
              checkbox.checked = item.checked;
            }
          });
        } catch (e) {
          console.error('Error loading saved state:', e);
        }
      }
      updateStats();

      const navLinks = document.querySelectorAll('.sidebar-nav .nav-link');
      const sections = document.querySelectorAll('.test-section[id], .workbook-intro[id], .summary-section[id]');
      const sidebar = document.querySelector('.docs-sidebar');
      const header = document.querySelector('.docs-header');

      function updateActiveNav() {
        let current = '';
        const scrollPos = window.scrollY + 200; // Offset for header

        sections.forEach(section => {
          const sectionTop = section.offsetTop;
          const sectionHeight = section.offsetHeight;
          if (scrollPos >= sectionTop && scrollPos < sectionTop + sectionHeight) {
            current = section.getAttribute('id');
          }
        });

        navLinks.forEach(link => {
          link.classList.remove('active');
          if (link.getAttribute('href') === '#' + current) {
            link.classList.add('active');
          }
        });
      }

      // Mobile menu toggle
      const menuButton = document.querySelector('.mobile-menu-toggle') || document.createElement('button');
      const backdrop = document.querySelector('.sidebar-backdrop');
      
      if (!menuButton.parentNode) {
        menuButton.className = 'mobile-menu-toggle';
        menuButton.innerHTML = '☰';
        menuButton.setAttribute('aria-label', 'Toggle menu');
        header.appendChild(menuButton);
      }

      function toggleSidebar() {
        sidebar.classList.toggle('open');
        if (backdrop) {
          backdrop.classList.toggle('active');
        }
      }

      menuButton.addEventListener('click', function(e) {
        e.stopPropagation();
        toggleSidebar();
      });

      // Close sidebar when clicking backdrop
      if (backdrop) {
        backdrop.addEventListener('click', function() {
          sidebar.classList.remove('open');
          backdrop.classList.remove('active');
        });
      }

      // Close sidebar when clicking outside on mobile
      document.addEventListener('click', function(e) {
        if (window.innerWidth <= 900 && sidebar && sidebar.classList.contains('open')) {
          if (!sidebar.contains(e.target) && !e.target.classList.contains('mobile-menu-toggle')) {
            sidebar.classList.remove('open');
            if (backdrop) {
              backdrop.classList.remove('active');
            }
          }
        }
      });

      // Close sidebar when clicking a nav link on mobile
      navLinks.forEach(link => {
        link.addEventListener('click', function() {
          if (window.innerWidth <= 900) {
            sidebar.classList.remove('open');
            if (backdrop) {
              backdrop.classList.remove('active');
            }
          }
        });
      });

      window.addEventListener('scroll', updateActiveNav);
      window.addEventListener('resize', function() {
        // Only auto-close sidebar if we're above mobile breakpoint
        if (window.innerWidth > 900) {
          sidebar.classList.remove('open');
          if (backdrop) {
            backdrop.classList.remove('active');
          }
        }
      });

      updateActiveNav(); // Initial call
    });
  </script>
</body>
</html>


<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Yarny React Migration - Testing Workbook</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="/global.css">
  <link rel="stylesheet" href="/docs.css">
  <link rel="stylesheet" href="/footer.css">
  <style>
    /* Keep content styling unchanged */
    .workbook-intro {
      background: rgba(31, 41, 55, 0.95);
      backdrop-filter: blur(10px);
      border-radius: var(--radius-lg);
      padding: var(--space-4xl);
      margin-bottom: var(--space-3xl);
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3), 0 10px 10px -5px rgba(0, 0, 0, 0.2);
      max-width: 1000px;
    }
    
    .workbook-intro h1 {
      color: var(--color-white);
      font-size: 2.5rem;
      margin-bottom: var(--space-md);
      font-weight: var(--font-weight-bold);
    }
    
    .workbook-intro p {
      color: rgba(255, 255, 255, 0.9);
      font-size: 1.1rem;
      line-height: 1.6;
      margin-bottom: var(--space-md);
    }
    
    .test-section {
      background: rgba(31, 41, 55, 0.6);
      border-radius: var(--radius-lg);
      padding: var(--space-4xl);
      margin-bottom: var(--space-4xl);
      border: 1px solid rgba(255, 255, 255, 0.1);
      max-width: 1000px;
    }
    
    .test-section h2 {
      color: var(--color-primary);
      font-size: 1.8rem;
      margin-bottom: var(--space-lg);
      display: flex;
      align-items: center;
      gap: var(--space-md);
    }
    
    .test-section h3 {
      color: rgba(255, 255, 255, 0.9);
      font-size: 1.3rem;
      margin-top: var(--space-3xl);
      margin-bottom: var(--space-md);
    }
    
    .test-item {
      background: rgba(31, 41, 55, 0.4);
      border-left: 4px solid var(--color-primary);
      padding: var(--space-xl);
      margin-bottom: var(--space-lg);
      border-radius: var(--radius-md);
    }
    
    .test-item h4 {
      color: rgba(255, 255, 255, 0.95);
      font-size: 1.1rem;
      margin-bottom: var(--space-sm);
      display: flex;
      align-items: center;
      gap: var(--space-sm);
    }
    
    .test-item p {
      color: rgba(255, 255, 255, 0.7);
      margin-bottom: var(--space-md);
      line-height: 1.6;
    }
    
    .test-steps {
      background: rgba(0, 0, 0, 0.2);
      padding: var(--space-lg);
      border-radius: var(--radius-md);
      margin-top: var(--space-md);
    }
    
    .test-steps ol {
      margin: 0;
      padding-left: var(--space-xl);
      color: rgba(255, 255, 255, 0.8);
    }
    
    .test-steps li {
      margin-bottom: var(--space-sm);
      line-height: 1.6;
    }
    
    .checkbox-container {
      display: flex;
      align-items: flex-start;
      gap: var(--space-md);
      margin-top: var(--space-md);
    }
    
    .checkbox-container input[type="checkbox"] {
      margin-top: 4px;
      width: 20px;
      height: 20px;
      cursor: pointer;
      flex-shrink: 0;
    }
    
    .checkbox-container label {
      color: rgba(255, 255, 255, 0.7);
      cursor: pointer;
      flex: 1;
    }
    
    .status-badge {
      display: inline-block;
      padding: 4px 12px;
      border-radius: var(--radius-full);
      font-size: 0.85rem;
      font-weight: var(--font-weight-semibold);
      margin-left: var(--space-sm);
    }
    
    .status-pass {
      background: rgba(16, 185, 129, 0.2);
      color: var(--color-primary);
      border: 1px solid var(--color-primary);
    }
    
    .status-fail {
      background: rgba(239, 68, 68, 0.2);
      color: #EF4444;
      border: 1px solid #EF4444;
    }
    
    .status-skip {
      background: rgba(156, 163, 175, 0.2);
      color: #9CA3AF;
      border: 1px solid #9CA3AF;
    }
    
    .note-box {
      background: rgba(254, 243, 199, 0.1);
      border-left: 4px solid #F59E0B;
      padding: var(--space-lg);
      margin: var(--space-lg) 0;
      border-radius: var(--radius-md);
    }
    
    .note-box p {
      color: rgba(255, 255, 255, 0.9);
      margin: 0;
    }
    
    .note-box strong {
      color: #F59E0B;
    }
    
    .summary-section {
      background: rgba(16, 185, 129, 0.1);
      border: 2px solid var(--color-primary);
      border-radius: var(--radius-lg);
      padding: var(--space-4xl);
      margin-top: var(--space-6xl);
      text-align: center;
    }
    
    .summary-section h2 {
      color: var(--color-primary);
      margin-bottom: var(--space-xl);
    }
    
    .summary-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: var(--space-xl);
      margin-top: var(--space-2xl);
    }
    
    .stat-box {
      background: rgba(31, 41, 55, 0.6);
      padding: var(--space-xl);
      border-radius: var(--radius-md);
    }
    
    .stat-box .stat-number {
      font-size: 2rem;
      font-weight: var(--font-weight-bold);
      color: var(--color-primary);
    }
    
    .stat-box .stat-label {
      color: rgba(255, 255, 255, 0.7);
      margin-top: var(--space-sm);
    }
  </style>
</head>
<body>
  <div class="docs-container">
    <main class="docs-main">
      <div class="sidebar-backdrop"></div>
      <aside class="docs-sidebar">
        <div class="sidebar-header">
          <div class="sidebar-branding">
            <h1>Yarny</h1>
            <p class="docs-subtitle">Your personal writing tool</p>
          </div>
          <a href="/migration-plan" style="color: var(--color-primary); text-decoration: none; font-weight: var(--font-weight-semibold); display: block; margin-bottom: var(--space-md);">
            Migration Plan
          </a>
        </div>
        <nav class="sidebar-nav">
          <ul class="sidebar-nav-list">
            <li><a href="#intro" class="nav-link">Introduction</a></li>
            <li><a href="#section-0" class="nav-link">Section 0: Test Corpus Setup</a></li>
            <li><a href="#section-1" class="nav-link">Section 1: Smoke Tests & Infrastructure</a></li>
            <li><a href="#section-2" class="nav-link">Section 2: Google Drive Integration & Sync</a></li>
            <li><a href="#section-3" class="nav-link">Section 3: Editor - Visual & IME</a></li>
            <li><a href="#section-4" class="nav-link">Section 4: Drag & Drop Visual</a></li>
            <li><a href="#section-5" class="nav-link">Section 5: Classic UX Anchors</a></li>
            <li><a href="#section-6" class="nav-link">Section 6: Notes Drag & Drop</a></li>
            <li><a href="#section-7" class="nav-link">Section 7: UI/UX Elements</a></li>
            <li><a href="#section-8" class="nav-link">Section 8: Export Functionality</a></li>
            <li><a href="#section-9" class="nav-link">Section 9: Performance & Edge Cases</a></li>
            <li><a href="#section-10" class="nav-link">Section 10: Round-Trip Validation (test-small)</a></li>
            <li><a href="#summary" class="nav-link">Testing Summary</a></li>
          </ul>
        </nav>
      </aside>

      <div class="docs-content">
        <nav class="docs-nav">
          <a href="/stories.html" id="storiesNavLink" class="btn-secondary" style="display: none;">My Stories</a>
          <a href="/docs.html" class="btn-secondary">Docs</a>
          <a href="/" id="loginNavLink" class="btn-secondary">Back to Login</a>
        </nav>
        <div class="workbook-intro" id="intro">
          <h1>Yarny React Migration - Manual Testing Workbook</h1>
          <p>This workbook guides you through the <strong>manual testing</strong> required after the React migration is complete. Most functional tests are now automated and run continuously in CI/CD.</p>
          <p><strong>Note:</strong> This workbook focuses on tests that require human judgment, visual verification, or subjective evaluation. Automated tests cover functional correctness, data persistence, calculations, and performance metrics.</p>
          <div class="note-box" style="margin-top: var(--space-lg);">
            <p><strong>Automated Testing:</strong> Functional tests (authentication, CRUD operations, data persistence, calculations, search, export, conflict resolution, etc.) are automated using Playwright and React Testing Library. These tests run on every PR and deployment.</p>
          </div>
          <div class="note-box" style="margin-top: var(--space-lg);">
            <p><strong>Test Corpus:</strong> For comprehensive testing, use the "Yarny Test Corpus" folder in Google Drive, which contains three project sizes (small, medium, large) with sample data. Start with the small project for basic tests, then use medium and large projects for performance and edge case testing.</p>
          </div>
        </div>

        <!-- Section 0: Test Corpus Setup -->
        <div class="test-section" id="section-0">
          <h2><i class="material-icons">folder</i> Section 0: Test Corpus Setup</h2>
          <p style="color: rgba(255, 255, 255, 0.7); margin-bottom: var(--space-lg);">Before running comprehensive tests, set up the test corpus in Google Drive. This provides standardized test data for validating all functionality across different project sizes.</p>
        
        <div class="test-item">
          <h4>Setup 0.1: Generate Test Corpus Files (If Not Already Done)</h4>
          <p>Generate the test corpus files locally. This only needs to be done once, or if you need to regenerate the files.</p>
          <div class="test-steps">
            <ol>
              <li>Open a terminal in the project root directory</li>
              <li>Navigate to the test-corpus directory: <code>cd test-corpus</code></li>
              <li>Run the generation script: <code>node generate-test-corpus.js</code></li>
              <li>Verify files are created:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li><code>test-medium/</code> directory with chapters, people, places, things folders</li>
                  <li><code>test-large/</code> directory with chapters, people, places, things folders</li>
                  <li>Metadata files: <code>test-medium/metadata.json</code> and <code>test-large/metadata.json</code></li>
                </ul>
              </li>
              <li>Verify file counts:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>test-medium: ~110 files (80 chapter snippets + 30 notes)</li>
                  <li>test-large: ~505 files (430 chapter snippets + 75 notes, including Chapter 13 with 55 snippets)</li>
                </ul>
              </li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="setup-0-1" name="setup-0-1">
            <label for="setup-0-1">Test corpus files generated successfully</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Setup 0.2: Create Google Drive Test Corpus Folder</h4>
          <p>Create the main test corpus folder in Google Drive and set up the folder structure.</p>
          <div class="test-steps">
            <ol>
              <li>Open Google Drive in your browser</li>
              <li>Create a new folder named <strong>"Yarny Test Corpus"</strong> (exact name is important)</li>
              <li>Note the folder ID from the URL (you'll need this later)</li>
              <li>Share the folder with the engineering team (set appropriate permissions)</li>
              <li>Verify the folder is accessible to all team members</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="setup-0-2" name="setup-0-2">
            <label for="setup-0-2">Google Drive test corpus folder created and shared</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Setup 0.3: Upload test-small Project</h4>
          <p>Upload the small test project (sample-project) to Google Drive. This is the simplest project for basic smoke tests.</p>
          <div class="test-steps">
            <ol>
              <li>In Google Drive, navigate to the "Yarny Test Corpus" folder</li>
              <li>Create a new folder named <strong>"test-small"</strong></li>
              <li>Inside test-small, create the story folder structure:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Create <strong>"Chapters"</strong> folder</li>
                  <li>Create <strong>"People"</strong> folder</li>
                  <li>Create <strong>"Places"</strong> folder</li>
                  <li>Create <strong>"Things"</strong> folder</li>
                </ul>
              </li>
              <li>Upload files from <code>test-corpus/sample-project/stories/</code>:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Upload as Google Docs (not plain text files)</li>
                  <li>Create appropriate chapter folders if needed</li>
                </ul>
              </li>
              <li>Create <code>project.json</code>, <code>data.json</code>, and <code>goal.json</code> files in the story folder (use structure from <code>src/utils/storyCreation.ts</code> as reference)</li>
              <li>Note the story folder ID for later use</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="setup-0-3" name="setup-0-3">
            <label for="setup-0-3">test-small project uploaded to Google Drive</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Setup 0.4: Upload test-medium Project</h4>
          <p>Upload the medium test project to Google Drive. This project has 10 chapters, 80 snippets, and 30 notes for realistic performance testing.</p>
          <div class="test-steps">
            <ol>
              <li>In Google Drive, navigate to the "Yarny Test Corpus" folder</li>
              <li>Create a new folder named <strong>"test-medium"</strong></li>
              <li>Inside test-medium, create the story folder structure:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Create <strong>"Chapters"</strong> folder</li>
                  <li>Create <strong>"People"</strong> folder</li>
                  <li>Create <strong>"Places"</strong> folder</li>
                  <li>Create <strong>"Things"</strong> folder</li>
                </ul>
              </li>
              <li>For each of the 10 chapters:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Create a chapter folder inside "Chapters" (e.g., "Chapter 1", "Chapter 2", etc.)</li>
                  <li>Upload the 8 snippet files from <code>test-corpus/test-medium/chapters/chapter-X/</code> as Google Docs</li>
                  <li>Name the Google Docs appropriately (e.g., "snippet-1-1", "snippet-1-2", etc.)</li>
                </ul>
              </li>
              <li>Upload People notes:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Upload 10 text files from <code>test-corpus/test-medium/people/</code> to the "People" folder</li>
                  <li>Upload as plain text files (not Google Docs)</li>
                </ul>
              </li>
              <li>Upload Places notes:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Upload 10 text files from <code>test-corpus/test-medium/places/</code> to the "Places" folder</li>
                  <li>Upload as plain text files</li>
                </ul>
              </li>
              <li>Upload Things notes:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Upload 10 text files from <code>test-corpus/test-medium/things/</code> to the "Things" folder</li>
                  <li>Upload as plain text files</li>
                </ul>
              </li>
              <li>Create <code>project.json</code>, <code>data.json</code>, and <code>goal.json</code> files in the story folder</li>
              <li>Update <code>test-corpus/test-medium/metadata.json</code> with actual Drive folder IDs</li>
              <li>Note the story folder ID for later use</li>
            </ol>
          </div>
          <div class="note-box" style="margin-top: var(--space-md);">
            <p><strong>Tip:</strong> You can use Google Drive API scripts or the Yarny app itself to help create the structure. The important part is that the final structure matches the expected format with proper folder organization.</p>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="setup-0-4" name="setup-0-4">
            <label for="setup-0-4">test-medium project uploaded to Google Drive (10 chapters, 80 snippets, 30 notes)</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Setup 0.5: Upload test-large Project</h4>
          <p>Upload the large test project to Google Drive. This project has 25 chapters, 430 chapter snippets (including Chapter 13 with 55 snippets), and 75 notes for stress testing and export chunking validation.</p>
          <div class="test-steps">
            <ol>
              <li>In Google Drive, navigate to the "Yarny Test Corpus" folder</li>
              <li>Create a new folder named <strong>"test-large"</strong></li>
              <li>Inside test-large, create the story folder structure:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Create <strong>"Chapters"</strong> folder</li>
                  <li>Create <strong>"People"</strong> folder</li>
                  <li>Create <strong>"Places"</strong> folder</li>
                  <li>Create <strong>"Things"</strong> folder</li>
                </ul>
              </li>
              <li>For each of the 25 chapters:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Create a chapter folder inside "Chapters" (e.g., "Chapter 1", "Chapter 2", etc.)</li>
                  <li><strong>Important:</strong> Chapter 13 should have 55 snippets (for export chunking tests)</li>
                  <li>All other chapters should have 15 snippets each</li>
                  <li>Upload snippet files from <code>test-corpus/test-large/chapters/chapter-X/</code> as Google Docs</li>
                  <li>Name the Google Docs appropriately</li>
                </ul>
              </li>
              <li>Upload People notes:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Upload 25 text files from <code>test-corpus/test-large/people/</code> to the "People" folder</li>
                  <li>Upload as plain text files</li>
                </ul>
              </li>
              <li>Upload Places notes:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Upload 25 text files from <code>test-corpus/test-large/places/</code> to the "Places" folder</li>
                  <li>Upload as plain text files</li>
                </ul>
              </li>
              <li>Upload Things notes:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Upload 25 text files from <code>test-corpus/test-large/things/</code> to the "Things" folder</li>
                  <li>Upload as plain text files</li>
                </ul>
              </li>
              <li>Create <code>project.json</code>, <code>data.json</code>, and <code>goal.json</code> files in the story folder</li>
              <li>Update <code>test-corpus/test-large/metadata.json</code> with actual Drive folder IDs</li>
              <li>Note the story folder ID for later use</li>
            </ol>
          </div>
          <div class="note-box" style="margin-top: var(--space-md);">
            <p><strong>Important:</strong> Chapter 13 must have 55 snippets to properly test export chunking functionality. This is critical for validating that large chapter exports handle Google Docs API body size limits correctly.</p>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="setup-0-5" name="setup-0-5">
            <label for="setup-0-5">test-large project uploaded to Google Drive (25 chapters, 430 chapter snippets including Chapter 13 with 55 snippets, 75 notes)</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Setup 0.6: Update Environment Variables</h4>
          <p>Configure environment variables to point to the test corpus folder in Google Drive.</p>
          <div class="test-steps">
            <ol>
              <li>Get the Google Drive folder ID for "Yarny Test Corpus":
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Open the folder in Google Drive</li>
                  <li>Copy the folder ID from the URL (the long string after <code>/folders/</code>)</li>
                </ul>
              </li>
              <li>Update your local <code>.env</code> file (or Netlify environment variables):
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Add or update: <code>VITE_TEST_CORPUS_FOLDER_ID=your-folder-id-here</code></li>
                </ul>
              </li>
              <li>If using Netlify, update environment variables in the Netlify dashboard:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Go to Site settings → Environment variables</li>
                  <li>Add or update <code>VITE_TEST_CORPUS_FOLDER_ID</code> with the folder ID</li>
                </ul>
              </li>
              <li>Verify the environment variable is set correctly</li>
              <li>Restart the development server if running locally</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="setup-0-6" name="setup-0-6">
            <label for="setup-0-6">Environment variables configured with test corpus folder ID</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Setup 0.7: Update Metadata Files with Drive IDs</h4>
          <p>Update the metadata.json files with actual Google Drive folder and file IDs for use in tests and MSW handlers.</p>
          <div class="test-steps">
            <ol>
              <li>For each test project (test-small, test-medium, test-large):
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Open the <code>metadata.json</code> file in the test-corpus directory</li>
                  <li>Replace <code>REPLACE_WITH_DRIVE_FOLDER_ID</code> placeholders with actual Drive folder IDs</li>
                  <li>Update story folder IDs</li>
                  <li>Update chapter folder IDs (if needed for your test setup)</li>
                  <li>Update snippet file IDs (if needed for your test setup)</li>
                </ul>
              </li>
              <li>Save the updated metadata files</li>
              <li>Verify the IDs are correct by checking in Google Drive</li>
              <li>Document the IDs for the engineering team (or commit to a shared location)</li>
            </ol>
          </div>
          <div class="note-box" style="margin-top: var(--space-md);">
            <p><strong>Note:</strong> The metadata files are used by MSW handlers and test fixtures. Keeping them up to date ensures tests can reference the correct Drive resources.</p>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="setup-0-7" name="setup-0-7">
            <label for="setup-0-7">Metadata files updated with actual Drive folder and file IDs</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Setup 0.8: Verify Test Corpus Structure</h4>
          <p>Verify that all test corpus projects are properly set up and accessible.</p>
          <div class="test-steps">
            <ol>
              <li>In Google Drive, navigate to "Yarny Test Corpus" folder</li>
              <li>Verify all three project folders exist: test-small, test-medium, test-large</li>
              <li>For each project, verify the structure:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Chapters folder exists with chapter subfolders</li>
                  <li>People, Places, Things folders exist with note files</li>
                  <li>project.json, data.json, and goal.json files exist in the story folder</li>
                </ul>
              </li>
              <li>Verify file counts:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>test-small: Basic structure (2+ snippets)</li>
                  <li>test-medium: 10 chapters × 8 snippets = 80 chapter snippets + 30 notes = 110 files</li>
                  <li>test-large: 25 chapters (Chapter 13 has 55, others have 15) = 430 chapter snippets + 75 notes = 505 files</li>
                </ul>
              </li>
              <li>Verify Chapter 13 in test-large has 55 snippets (critical for export chunking tests)</li>
              <li>Test accessing the projects in Yarny:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Open Yarny and navigate to the test corpus stories</li>
                  <li>Verify stories load correctly</li>
                  <li>Verify chapters and snippets are visible</li>
                  <li>Verify notes are accessible</li>
                </ul>
              </li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="setup-0-8" name="setup-0-8">
            <label for="setup-0-8">Test corpus structure verified and accessible in Yarny</label>
          </div>
        </div>

        <div class="note-box" style="margin-top: var(--space-2xl);">
          <p><strong>Test Corpus Usage:</strong> Once set up, use these test projects for comprehensive testing:</p>
          <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl); color: rgba(255, 255, 255, 0.9);">
            <li><strong>test-small:</strong> Fast smoke tests, basic operations, format normalization, IME composition, RTL handling</li>
            <li><strong>test-medium:</strong> Realistic project size, performance testing, export operations</li>
            <li><strong>test-large:</strong> Stress testing, virtualization validation, lazy loading, export chunking (especially Chapter 13 with 50+ snippets)</li>
          </ul>
        </div>
      </div>

        <!-- Note: Authentication and Story Management tests are fully automated -->
        <!-- 
          Logical Testing Order (sections are now numbered in this order):
          1. Section 0: Test Corpus Setup (prerequisite)
          2. Section 1: Smoke Tests & Infrastructure (verify environment)
          3. Section 2: Google Drive Integration (foundational dependency)
          4. Section 3: Editor Testing (core editing functionality)
          5. Section 4: Drag & Drop (editor interaction)
          6. Section 5: Classic UX Anchors (UI consistency)
          7. Section 6: Notes Drag & Drop (notes functionality)
          8. Section 7: UI/UX Elements (general UI)
          9. Section 8: Export (depends on having content)
          10. Section 9: Performance & Edge Cases (stress testing)
          11. Section 10: Round-Trip Validation (comprehensive end-to-end)
        -->

        <!-- Section 3: Editor - Visual & IME Testing -->
        <div class="test-section" id="section-3">
          <h2><i class="material-icons">edit</i> Section 3: Editor - Visual & IME Testing</h2>
          <p style="color: rgba(255, 255, 255, 0.7); margin-bottom: var(--space-lg);">These tests require visual verification or human judgment. Functional editor tests (open snippet, edit content, auto-save, word count) are automated.</p>
        
        <div class="test-item">
          <h4>Test 1.1: Plain Text Only (No Rich Formatting) - Visual Verification</h4>
          <p>Verify that the editor only supports plain text (no bold, italic, colors, etc.) and preserves paragraph/line breaks correctly.</p>
          <div class="test-steps">
            <ol>
              <li>Type some text in the editor</li>
              <li>Try to make text bold (Ctrl+B or Cmd+B) - it should NOT work</li>
              <li>Try to make text italic (Ctrl+I or Cmd+I) - it should NOT work</li>
              <li>Paste rich text from another document</li>
              <li>Verify the formatting is stripped and only plain text remains</li>
              <li>Test paragraph breaks: Press Enter twice to create a paragraph break</li>
              <li>Verify paragraph breaks (double Enter) create proper spacing between paragraphs</li>
              <li>Test soft line breaks: Press Shift+Enter to create a line break within a paragraph</li>
              <li>Verify single line breaks (Shift+Enter) work correctly without creating new paragraphs</li>
              <li>Save the snippet and open it in Google Docs</li>
              <li>Verify paragraph breaks and line breaks are preserved correctly in Google Docs</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-1-1" name="test-1-1">
            <label for="test-1-1">Editor only supports plain text and preserves paragraph/line breaks correctly</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 1.2: IME Composition Handling (Japanese/Chinese/Korean Input)</h4>
          <p>Verify that the editor handles IME (Input Method Editor) composition correctly for Japanese, Chinese, and Korean text input.</p>
          <div class="test-steps">
            <ol>
              <li>Enable Japanese IME on your computer (or use browser dev tools to simulate)</li>
              <li>Open a snippet in the Yarny editor</li>
              <li>Start typing in Japanese (e.g., "こんにちは" - konnichiwa)</li>
              <li>While composing (before pressing Enter to confirm), verify word count does NOT update prematurely</li>
              <li>Complete the IME composition (press Enter to confirm)</li>
              <li>Verify word count updates only after composition ends</li>
              <li>Verify save debouncing respects composition (doesn't save during composition)</li>
              <li>Repeat with Chinese text (e.g., "你好" - nǐ hǎo)</li>
              <li>Repeat with Korean text (e.g., "안녕하세요" - annyeonghaseyo)</li>
              <li>Verify all IME compositions work correctly</li>
              <li>Save the snippet and verify the text is preserved correctly</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-1-2" name="test-1-2">
            <label for="test-1-2">IME composition handling works correctly for Japanese/Chinese/Korean input</label>
          </div>
        </div>

      </div>

        <!-- Section 4: Drag & Drop Visual Testing -->
        <div class="test-section" id="section-4">
          <h2><i class="material-icons">folder</i> Section 4: Drag & Drop Visual Testing</h2>
          <p style="color: rgba(255, 255, 255, 0.7); margin-bottom: var(--space-lg);">These tests require visual verification of drag & drop feedback. Functional drag & drop operations (create, rename, delete chapters/snippets) are automated.</p>
        
        <div class="test-item">
          <h4>Test 4.1: Drag & Drop Reorder Chapters - Visual Feedback</h4>
          <p>Verify that you can reorder chapters by dragging and dropping.</p>
          <div class="test-steps">
            <ol>
              <li>Click and hold on a chapter in the left sidebar</li>
              <li>Drag it up or down to a new position</li>
              <li>Release to drop it</li>
              <li>Verify the chapter moves to the new position</li>
              <li>Refresh the page</li>
              <li>Verify the chapter order is preserved</li>
              <li>Verify the order is saved in Google Drive</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-2-1" name="test-2-1">
            <label for="test-2-1">I can reorder chapters by dragging and dropping</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 4.2: Drag & Drop Reorder Snippets - Visual Feedback</h4>
          <p>Verify that you can reorder snippets within a chapter by dragging and dropping.</p>
          <div class="test-steps">
            <ol>
              <li>Click and hold on a snippet in the left sidebar</li>
              <li>Drag it up or down within the same chapter</li>
              <li>Release to drop it</li>
              <li>Verify the snippet moves to the new position</li>
              <li>Refresh the page</li>
              <li>Verify the snippet order is preserved</li>
              <li>Verify the order is saved in Google Drive</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-2-2" name="test-2-2">
            <label for="test-2-2">I can reorder snippets by dragging and dropping</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 4.3: Drag & Drop Move Snippet Between Chapters - Visual Feedback</h4>
          <p>Verify that you can move a snippet from one chapter to another by dragging and dropping.</p>
          <div class="test-steps">
            <ol>
              <li>Click and hold on a snippet</li>
              <li>Drag it to a different chapter</li>
              <li>Release to drop it</li>
              <li>Verify the snippet moves to the new chapter</li>
              <li>Verify the snippet disappears from the old chapter</li>
              <li>Refresh the page</li>
              <li>Verify the snippet is still in the new chapter</li>
              <li>Verify the Google Doc is moved to the new chapter folder in Google Drive</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-2-3" name="test-2-3">
            <label for="test-2-3">I can move snippets between chapters by dragging and dropping</label>
          </div>
        </div>

      </div>

        <!-- Note: Sections 5 and 6 (Color Coding, Search) are fully automated -->

        <!-- Section 5: Classic UX Anchors - Visual Parity -->
        <div class="test-section" id="section-5">
          <h2><i class="material-icons">track_changes</i> Section 5: Classic UX Anchors - Visual Parity</h2>
          <p style="color: rgba(255, 255, 255, 0.7); margin-bottom: var(--space-lg);">These tests require visual comparison with the original app to verify design parity. Functional goal tests (set goal, calculations, updates) are automated.</p>
        
        <div class="test-item">
          <h4>Test 5.1: Goal Meter - Visual Parity Check</h4>
          <p>Verify that the goal meter in the left sidebar displays correctly.</p>
          <div class="test-steps">
            <ol>
              <li>In the editor, look at the left sidebar</li>
              <li>Find the goal meter (should show "X / Y" where X is current word count and Y is goal)</li>
              <li>Verify it shows "0 / 3,000" or similar if a goal is set</li>
              <li>Verify a progress bar shows completion percentage</li>
              <li>Click on the goal meter</li>
              <li>Verify the goal panel modal opens</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-3-1" name="test-3-1">
            <label for="test-3-1">Goal meter displays correctly and is clickable</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 5.2: "Today • N" Chip - Visual Parity Check</h4>
          <p>Verify that the "Today • N" chip displays daily word count correctly.</p>
          <div class="test-steps">
            <ol>
              <li>In the editor, look at the left sidebar below the goal meter</li>
              <li>Find the "Today • N" chip (where N is today's word count)</li>
              <li>Verify it shows "Today • 0" or the actual daily word count</li>
              <li>Write some text in a snippet</li>
              <li>Verify the "Today • N" number updates</li>
              <li>Verify a progress bar shows daily progress (if daily target is set)</li>
              <li>Click on the chip</li>
              <li>Verify the goal panel modal opens</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-3-2" name="test-3-2">
            <label for="test-3-2">"Today • N" chip displays and updates correctly</label>
          </div>
        </div>

      </div>

        <!-- Section 6: Notes Drag & Drop Visual Testing -->
        <div class="test-section" id="section-6">
          <h2><i class="material-icons">note</i> Section 6: Notes Drag & Drop Visual Testing</h2>
          <p style="color: rgba(255, 255, 255, 0.7); margin-bottom: var(--space-lg);">This test requires visual verification of drag & drop feedback. Functional notes tests (create, edit, rename, delete) are automated.</p>
        
        <div class="test-item">
          <h4>Test 6.1: Reorder Notes (Drag & Drop) - Visual Feedback</h4>
          <p>Verify that you can reorder notes by dragging and dropping.</p>
          <div class="test-steps">
            <ol>
              <li>Click and hold on a note in the right sidebar</li>
              <li>Drag it up or down to a new position</li>
              <li>Release to drop it</li>
              <li>Verify the note moves to the new position</li>
              <li>Refresh the page</li>
              <li>Verify the note order is preserved</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-4-1" name="test-4-1">
            <label for="test-4-1">I can reorder notes by dragging and dropping</label>
          </div>
        </div>
      </div>

        <!-- Section 8: Export Functionality -->
        <div class="test-section" id="section-8">
          <h2><i class="material-icons">file_download</i> Section 8: Export Functionality</h2>
          <p style="color: rgba(255, 255, 255, 0.7); margin-bottom: var(--space-lg);">Export functionality depends on having content created and edited. Complete this section after basic editing and content creation tests.</p>
        
        <div class="test-item">
          <h4>Test 8.1: Export All Chapters</h4>
          <p>Verify that you can export all chapters as a single Google Doc.</p>
          <div class="test-steps">
            <ol>
              <li>In the editor, look for an "Export" button or menu</li>
              <li>Click it and select "Export All Chapters"</li>
              <li>Enter a filename for the export</li>
              <li>Optionally choose to include snippet names</li>
              <li>Click "Export"</li>
              <li>Verify a new Google Doc is created in the story folder in Google Drive</li>
              <li>Open the exported Google Doc</li>
              <li>Verify all chapters and snippets are included in order</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-5-1" name="test-5-1">
            <label for="test-5-1">I can export all chapters as a Google Doc</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 8.2: Export Outline</h4>
          <p>Verify that you can export an outline (chapter and snippet titles with descriptions).</p>
          <div class="test-steps">
            <ol>
              <li>Click "Export" and select "Export Outline"</li>
              <li>Enter a filename for the export</li>
              <li>Click "Export"</li>
              <li>Verify a new Google Doc is created in the story folder</li>
              <li>Open the exported Google Doc</li>
              <li>Verify it contains chapter titles, snippet titles, and descriptions</li>
              <li>Verify it does NOT contain snippet body content</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-5-2" name="test-5-2">
            <label for="test-5-2">I can export an outline with titles and descriptions</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 8.3: Export All People</h4>
          <p>Verify that you can export all People notes as a single Google Doc.</p>
          <div class="test-steps">
            <ol>
              <li>Click "Export" and select "Export All People"</li>
              <li>Enter a filename for the export</li>
              <li>Click "Export"</li>
              <li>Verify a new Google Doc is created in the story folder</li>
              <li>Open the exported Google Doc</li>
              <li>Verify it contains all People notes with their content</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-5-3" name="test-5-3">
            <label for="test-5-3">I can export all People notes</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 8.4: Export All Places</h4>
          <p>Verify that you can export all Places notes as a single Google Doc.</p>
          <div class="test-steps">
            <ol>
              <li>Click "Export" and select "Export All Places"</li>
              <li>Enter a filename for the export</li>
              <li>Click "Export"</li>
              <li>Verify a new Google Doc is created in the story folder</li>
              <li>Open the exported Google Doc</li>
              <li>Verify it contains all Places notes with their content</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-5-4" name="test-5-4">
            <label for="test-5-4">I can export all Places notes</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 8.5: Export All Things</h4>
          <p>Verify that you can export all Things notes as a single Google Doc.</p>
          <div class="test-steps">
            <ol>
              <li>Click "Export" and select "Export All Things"</li>
              <li>Enter a filename for the export</li>
              <li>Click "Export"</li>
              <li>Verify a new Google Doc is created in the story folder</li>
              <li>Open the exported Google Doc</li>
              <li>Verify it contains all Things notes with their content</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-5-5" name="test-5-5">
            <label for="test-5-5">I can export all Things notes</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 8.6: Export Large Chapter (Chunked Writes)</h4>
          <p>Verify that exporting a very large chapter (50+ snippets) uses chunked writes to handle Google Docs API body size limits.</p>
          <div class="test-steps">
            <ol>
              <li>Open a story with a very large chapter (50+ snippets) - use test-large project if available</li>
              <li>Click "Export" and select "Export All Chapters" (or export just the large chapter)</li>
              <li>Enter a filename for the export</li>
              <li>Click "Export"</li>
              <li>Verify a progress indicator appears during export (if chunked writes are used)</li>
              <li>Verify the export completes successfully without errors</li>
              <li>Verify all snippets are included in the export (no truncation)</li>
              <li>Open the exported Google Doc</li>
              <li>Verify all snippets are in the correct order</li>
              <li>Verify the export order is preserved across chunks (if chunked)</li>
              <li>Verify the exported document is complete and readable</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-5-6" name="test-5-6">
            <label for="test-5-6">Large chapter export uses chunked writes correctly</label>
          </div>
        </div>
      </div>

        <!-- Section 2: Google Drive Integration & Sync -->
        <div class="test-section" id="section-2">
          <h2><i class="material-icons">cloud</i> Section 2: Google Drive Integration & Sync</h2>
          <p style="color: rgba(255, 255, 255, 0.7); margin-bottom: var(--space-lg);">Google Drive integration is foundational - most other features depend on it working correctly.</p>
        
        <div class="test-item">
          <h4>Test 2.1: Files Created in Google Drive</h4>
          <p>Verify that all created items (stories, chapters, snippets, notes) appear in Google Drive.</p>
          <div class="test-steps">
            <ol>
              <li>Create a new story in Yarny</li>
              <li>Open Google Drive in another tab</li>
              <li>Navigate to "Yarny Stories" folder</li>
              <li>Verify the story folder exists</li>
              <li>Create a chapter and snippet in Yarny</li>
              <li>Refresh Google Drive</li>
              <li>Verify the chapter folder and snippet Google Doc exist in the story folder</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-6-1" name="test-6-1">
            <label for="test-6-1">All created items appear in Google Drive</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 2.2: Changes Saved to Google Drive</h4>
          <p>Verify that edits made in Yarny are saved to Google Drive files.</p>
          <div class="test-steps">
            <ol>
              <li>Edit a snippet in Yarny</li>
              <li>Wait for auto-save to complete (check save status)</li>
              <li>Open the snippet's Google Doc in Google Drive</li>
              <li>Verify your changes appear in the Google Doc</li>
              <li>Edit a note in Yarny</li>
              <li>Open the note's text file in Google Drive</li>
              <li>Verify your changes appear in the text file</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-6-2" name="test-6-2">
            <label for="test-6-2">Changes are saved to Google Drive files</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 2.3: Round-Trip Editing (Yarny → Google Docs → Yarny)</h4>
          <p>Verify that you can edit in Google Docs and see changes in Yarny with no format loss (plain text only).</p>
          <div class="test-steps">
            <ol>
              <li>Edit a snippet in Yarny with paragraph breaks (double Enter) and line breaks (Shift+Enter)</li>
              <li>Save the snippet in Yarny</li>
              <li>Open the same snippet's Google Doc in Google Docs (another tab)</li>
              <li>Verify the content matches exactly (paragraph breaks and line breaks preserved)</li>
              <li>Make changes in Google Docs (add text, modify existing text)</li>
              <li>Save in Google Docs</li>
              <li>In Yarny, switch to a different snippet (or close and reopen Yarny)</li>
              <li>Switch back to the original snippet</li>
              <li>Verify Yarny detects the external changes (may show conflict resolution or reconciliation)</li>
              <li>Verify you can see the changes from Google Docs</li>
              <li>Verify paragraph breaks and line breaks are still preserved correctly</li>
              <li>Verify no formatting (bold, italic, etc.) was introduced</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-6-3" name="test-6-3">
            <label for="test-6-3">I can edit in Google Docs and see changes in Yarny with no format loss</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 2.3a: Cross-Edit Testing (Yarny Idle → Google Docs Edit → Yarny)</h4>
          <p>Verify that Yarny detects changes made in Google Docs while Yarny is idle (not actively editing the snippet).</p>
          <div class="test-steps">
            <ol>
              <li>Open a snippet in Yarny (make it the active snippet)</li>
              <li>Switch to a different snippet in Yarny (make the first snippet idle, not actively being edited)</li>
              <li>In another tab, open the first snippet's Google Doc in Google Docs</li>
              <li>Make edits in Google Docs</li>
              <li>Save in Google Docs</li>
              <li>Return to Yarny and switch back to the first snippet</li>
              <li>Verify Yarny detects the external changes</li>
              <li>Verify a conflict resolution modal or reconciliation notification appears</li>
              <li>Verify you can see the changes from Google Docs</li>
              <li>Verify you can choose to keep Yarny version or use Google Docs version</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-6-3a" name="test-6-3a">
            <label for="test-6-3a">Yarny detects changes made in Google Docs while snippet is idle</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 2.4: Conflict Detection</h4>
          <p>Verify that Yarny detects conflicts when both Yarny and Google Docs are edited (but NOT while actively editing in Yarny).</p>
          <div class="test-steps">
            <ol>
              <li>Edit a snippet in Yarny and save</li>
              <li>Switch to a different snippet in Yarny (make the first snippet idle)</li>
              <li>Open the first snippet's Google Doc in Google Docs (another tab)</li>
              <li>Make different changes in Google Docs</li>
              <li>Save in Google Docs</li>
              <li>In Yarny, switch back to the original snippet</li>
              <li>Verify a conflict resolution modal appears (conflicts are detected when switching snippets, not while actively editing)</li>
              <li>Verify you can see both versions (Yarny version vs Google Docs version)</li>
              <li>Verify the modal shows timestamps for both versions</li>
              <li>Verify you can compare the differences</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-6-4" name="test-6-4">
            <label for="test-6-4">Conflict detection works when both are edited (detected on snippet switch)</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 2.5: Conflict Resolution - Keep Yarny Version</h4>
          <p>Verify that you can resolve conflicts by keeping the Yarny version.</p>
          <div class="test-steps">
            <ol>
              <li>Trigger a conflict (see Test 2.4)</li>
              <li>In the conflict resolution modal, choose "Keep Yarny Version"</li>
              <li>Verify the Yarny version is kept</li>
              <li>Verify the Google Doc is updated with the Yarny version</li>
              <li>Open the Google Doc in Google Docs</li>
              <li>Verify it matches the Yarny version</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-6-5" name="test-6-5">
            <label for="test-6-5">I can resolve conflicts by keeping Yarny version</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 2.6: Conflict Resolution - Use Google Docs Version</h4>
          <p>Verify that you can resolve conflicts by using the Google Docs version.</p>
          <div class="test-steps">
            <ol>
              <li>Trigger a conflict (see Test 2.4)</li>
              <li>In the conflict resolution modal, choose "Use Google Docs Version"</li>
              <li>Verify the Google Docs version replaces the Yarny content</li>
              <li>Verify the editor shows the Google Docs content</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-6-6" name="test-6-6">
            <label for="test-6-6">I can resolve conflicts by using Google Docs version</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 2.7: Reconciliation on Window Focus</h4>
          <p>Verify that Yarny checks for external changes when the window regains focus.</p>
          <div class="test-steps">
            <ol>
              <li>Open a snippet in Yarny</li>
              <li>Switch to another browser tab</li>
              <li>Edit the snippet's Google Doc in Google Docs</li>
              <li>Save in Google Docs</li>
              <li>Switch back to the Yarny tab (window regains focus)</li>
              <li>Verify Yarny detects the external changes</li>
              <li>Verify a reconciliation notification appears (or conflict modal if content differs)</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-6-7" name="test-6-7">
            <label for="test-6-7">Yarny checks for external changes on window focus</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 2.8: Comments/Tracked Changes Warning</h4>
          <p>Verify that Yarny warns about comments or tracked changes in Google Docs.</p>
          <div class="test-steps">
            <ol>
              <li>Open a snippet's Google Doc in Google Docs</li>
              <li>Add a comment to the document</li>
              <li>Save in Google Docs</li>
              <li>In Yarny, try to save the snippet (or switch snippets)</li>
              <li>Verify a warning modal appears about comments/tracked changes</li>
              <li>Verify you can acknowledge the warning and proceed</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-6-8" name="test-6-8">
            <label for="test-6-8">Yarny warns about comments/tracked changes in Google Docs</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 2.9: Cross-Tab Yarny Conflicts</h4>
          <p>Verify that Yarny detects and prevents conflicts when the same snippet is edited in multiple Yarny tabs.</p>
          <div class="test-steps">
            <ol>
              <li>Open Yarny in two browser tabs (Tab 1 and Tab 2)</li>
              <li>In Tab 1, open a snippet and start editing</li>
              <li>In Tab 2, try to open the same snippet</li>
              <li>Verify Tab 2 shows "Editing in another tab" message or read-only indicator</li>
              <li>Verify Tab 2 is read-only (cannot edit) while Tab 1 is editing</li>
              <li>Save the snippet in Tab 1</li>
              <li>Switch to Tab 2</li>
              <li>Verify Tab 2 updates with the latest content from Tab 1</li>
              <li>Close Tab 1</li>
              <li>Verify Tab 2 regains edit capability (no longer read-only)</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-6-9" name="test-6-9">
            <label for="test-6-9">Cross-tab conflict detection prevents simultaneous editing</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 2.10: Format Normalization (Line Endings, NBSPs, Trailing Spaces)</h4>
          <p>Verify that Yarny normalizes text format to match Google Docs behavior (mixed line endings, non-breaking spaces, trailing spaces).</p>
          <div class="test-steps">
            <ol>
              <li>Create a snippet with mixed line endings: some lines ending with `\n`, some with `\r\n`, some with `\r`</li>
              <li>Add non-breaking spaces (NBSP) in the text</li>
              <li>Add trailing spaces at the end of some lines</li>
              <li>Save the snippet in Yarny</li>
              <li>Open the Google Doc in Google Drive</li>
              <li>Verify all line endings are normalized to `\n` (no `\r\n` or `\r`)</li>
              <li>Verify NBSPs are normalized to regular spaces</li>
              <li>Verify trailing spaces are handled correctly (may be collapsed by Google Docs)</li>
              <li>Edit the snippet in Google Docs and add more mixed formatting</li>
              <li>Switch snippets in Yarny and switch back</li>
              <li>Verify the text is normalized correctly after round-trip</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-6-10" name="test-6-10">
            <label for="test-6-10">Format normalization works correctly (line endings, NBSPs, trailing spaces)</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 2.11: Visibility-Based Request Gating</h4>
          <p>Verify that Yarny only makes background requests when the browser tab is visible (prevents Drive quota exhaustion).</p>
          <div class="test-steps">
            <ol>
              <li>Open Yarny in multiple browser tabs</li>
              <li>Open a story with many snippets in Tab 1</li>
              <li>Switch to Tab 2 (Tab 1 becomes hidden)</li>
              <li>Check browser network tab or console</li>
              <li>Verify Tab 1 stops making background prefetch requests when hidden</li>
              <li>Switch back to Tab 1 (tab becomes visible)</li>
              <li>Verify background prefetch requests resume in Tab 1</li>
              <li>Verify only the visible tab makes background requests</li>
              <li>Test with mutations (save, delete, rename) in hidden tab</li>
              <li>Verify mutations also respect visibility gating (may be queued or delayed)</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-6-11" name="test-6-11">
            <label for="test-6-11">Visibility-based request gating prevents quota exhaustion</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 2.12: Drive API Rate Limiting (429 Errors)</h4>
          <p>Verify that Yarny handles Drive API rate limit errors (429) gracefully with exponential backoff.</p>
          <div class="test-steps">
            <ol>
              <li>Trigger rate limiting by making rapid requests (or simulate 429 error)</li>
              <li>Verify Yarny detects the 429 rate limit error</li>
              <li>Verify exponential backoff with jitter is applied (delays between retries: 1s, 2s, 4s, etc.)</li>
              <li>Verify retry only happens when tab is visible (background tabs don't retry)</li>
              <li>Verify a clear error message is displayed to the user</li>
              <li>Verify automatic retry happens after backoff delay</li>
              <li>Verify no infinite retry loops (max 3 retries)</li>
              <li>After successful retry, verify the operation completes</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-6-12" name="test-6-12">
            <label for="test-6-12">Drive API rate limiting is handled gracefully with exponential backoff</label>
          </div>
        </div>
      </div>

        <!-- Section 7: UI/UX Elements -->
        <div class="test-section" id="section-7">
          <h2><i class="material-icons">design_services</i> Section 7: UI/UX Elements</h2>
        
        <div class="test-item">
          <h4>Test 7.1: Classic UX Anchors - Goal Meter</h4>
          <p>Verify that the goal meter looks and behaves identically to the original app.</p>
          <div class="test-steps">
            <ol>
              <li>Compare the goal meter in the left sidebar with the original app (if available)</li>
              <li>Verify it shows "X / Y" format (e.g., "0 / 3,000")</li>
              <li>Verify the progress bar styling matches (colors, height, border radius)</li>
              <li>Verify clicking it opens the goal panel</li>
              <li>Verify it updates in real-time as you write</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-7-1" name="test-7-1">
            <label for="test-7-1">Goal meter looks and behaves identically to original</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 7.2: Classic UX Anchors - "Today • N" Chip</h4>
          <p>Verify that the "Today • N" chip looks and behaves identically to the original app.</p>
          <div class="test-steps">
            <ol>
              <li>Compare the "Today • N" chip with the original app (if available)</li>
              <li>Verify it shows "Today • N" format with number formatting (commas for large numbers)</li>
              <li>Verify the progress bar styling matches (2px height, subtle background)</li>
              <li>Verify color logic (green/red in strict mode, primary color otherwise)</li>
              <li>Verify clicking it opens the goal panel</li>
              <li>Verify it always shows (even when no goal set, shows "—")</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-7-2" name="test-7-2">
            <label for="test-7-2">"Today • N" chip looks and behaves identically to original</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 7.3: Classic UX Anchors - Footer Word/Character Counts</h4>
          <p>Verify that the footer word/character counts look and behave identically to the original app.</p>
          <div class="test-steps">
            <ol>
              <li>Compare the footer counts with the original app (if available)</li>
              <li>Verify it shows "Words: N — Characters: N" format</li>
              <li>Verify the font size, color, and spacing match</li>
              <li>Verify it updates in real-time as you type</li>
              <li>Verify it shows counts for active snippet only</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-7-3" name="test-7-3">
            <label for="test-7-3">Footer word/character counts look and behave identically to original</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 7.4: Modals - Open and Close</h4>
          <p>Verify that all modals open and close correctly.</p>
          <div class="test-steps">
            <ol>
              <li>Test opening each modal: Story Info, Export, Description Edit, Goal Panel, Rename, Delete, Conflict Resolution, Comments Warning</li>
              <li>Verify each modal opens when triggered</li>
              <li>Verify you can close modals by: clicking X button, clicking outside modal, pressing Escape key</li>
              <li>Verify modals don't overlap or break layout</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-7-4" name="test-7-4">
            <label for="test-7-4">All modals open and close correctly</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 7.5: Context Menus</h4>
          <p>Verify that right-click context menus work correctly.</p>
          <div class="test-steps">
            <ol>
              <li>Right-click on a chapter in the left sidebar</li>
              <li>Verify a context menu appears with options (Rename, Delete, Change Color, etc.)</li>
              <li>Right-click on a snippet</li>
              <li>Verify a context menu appears with options</li>
              <li>Click on a menu option</li>
              <li>Verify the action is performed</li>
              <li>Click outside the menu</li>
              <li>Verify the menu closes</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-7-5" name="test-7-5">
            <label for="test-7-5">Context menus work correctly</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 7.6: Mobile Device Warning</h4>
          <p>Verify that mobile devices show a warning message.</p>
          <div class="test-steps">
            <ol>
              <li>Access Yarny from a mobile device (or use browser dev tools to simulate mobile)</li>
              <li>Verify a warning message appears</li>
              <li>Verify the message says to use a computer</li>
              <li>Verify you can navigate back to stories from the warning</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-7-6" name="test-7-6">
            <label for="test-7-6">Mobile devices show warning message</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 7.7: Loading States</h4>
          <p>Verify that loading indicators appear during data fetching.</p>
          <div class="test-steps">
            <ol>
              <li>Open a story with many snippets</li>
              <li>Verify loading indicators appear while snippets load</li>
              <li>Switch between snippets</li>
              <li>Verify loading states appear if content isn't cached</li>
              <li>Verify the UI doesn't freeze during loading</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-7-7" name="test-7-7">
            <label for="test-7-7">Loading indicators appear during data fetching</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 7.8: Error Messages</h4>
          <p>Verify that error messages are clear and helpful.</p>
          <div class="test-steps">
            <ol>
              <li>Try to perform an action that might fail (e.g., save with network disconnected)</li>
              <li>Verify an error message appears</li>
              <li>Verify the error message is clear and explains what went wrong</li>
              <li>Verify you can retry the action if applicable</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-7-8" name="test-7-8">
            <label for="test-7-8">Error messages are clear and helpful</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 7.9: Accessible Focus Rings</h4>
          <p>Verify that focus rings are visible and accessible when navigating with keyboard (especially on dark cards and pale chips).</p>
          <div class="test-steps">
            <ol>
              <li>Use Tab key to navigate through the interface (don't use mouse)</li>
              <li>Navigate to elements in the left sidebar (dark card background)</li>
              <li>Verify focus rings are visible on dark backgrounds (should be lighter color, e.g., primary-light)</li>
              <li>Navigate to elements on pale chip backgrounds</li>
              <li>Verify focus rings are visible on light backgrounds (should be darker color, e.g., primary-dark)</li>
              <li>Navigate through modals and buttons</li>
              <li>Verify all interactive elements show clear focus indicators</li>
              <li>Verify focus rings are 2px solid with 2px offset (accessible standard)</li>
              <li>Test with high contrast mode enabled (if available)</li>
              <li>Verify focus rings remain visible in all contexts</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-7-9" name="test-7-9">
            <label for="test-7-9">Focus rings are visible and accessible on all backgrounds</label>
          </div>
        </div>
      </div>

        <!-- Section 9: Performance & Edge Cases -->
        <div class="test-section" id="section-9">
          <h2><i class="material-icons">speed</i> Section 9: Performance & Edge Cases</h2>
          <p style="color: rgba(255, 255, 255, 0.7); margin-bottom: var(--space-lg);">Performance and edge case testing should come after basic functionality is validated.</p>
        
        <div class="test-item">
          <h4>Test 9.1: Large Story Performance</h4>
          <p>Verify that the app performs well with large stories (many chapters and snippets).</p>
          <div class="test-steps">
            <ol>
              <li>Open a story with 25+ chapters and 200+ snippets (if available)</li>
              <li>Verify the app loads in a reasonable time (< 5 seconds)</li>
              <li>Scroll through the chapter/snippet list</li>
              <li>Verify scrolling is smooth (no lag)</li>
              <li>Switch between snippets</li>
              <li>Verify snippet switching is responsive</li>
              <li>Verify the UI doesn't freeze or become unresponsive</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-8-1" name="test-8-1">
            <label for="test-8-1">App performs well with large stories</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 9.2: Lazy Loading</h4>
          <p>Verify that snippet content loads on demand (lazy loading).</p>
          <div class="test-steps">
            <ol>
              <li>Open a story with many snippets</li>
              <li>Verify the active snippet loads immediately</li>
              <li>Verify other snippets load in the background (check network tab or wait)</li>
              <li>Switch to a different snippet</li>
              <li>Verify it loads quickly (may be from cache if already loaded)</li>
              <li>Verify the UI doesn't block while loading</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-8-2" name="test-8-2">
            <label for="test-8-2">Snippet content loads on demand (lazy loading)</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 9.3: Performance Budget - Time to First Edit (Hot Path)</h4>
          <p>Verify that opening a snippet already in cache and starting to type is fast (≤300 ms from click to first character appearing).</p>
          <div class="test-steps">
            <ol>
              <li>Open a story and load a snippet (content is now cached)</li>
              <li>Switch to a different snippet and back to the first one (ensures it's in cache)</li>
              <li>Click on the snippet to open it in the editor</li>
              <li>Start typing immediately</li>
              <li>Measure time from click to first character appearing (use browser dev tools or stopwatch)</li>
              <li>Verify latency is ≤300 ms (hot path - snippet already in cache)</li>
              <li>Repeat with several different snippets</li>
              <li>Verify all meet the performance budget</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-8-3" name="test-8-3">
            <label for="test-8-3">Time to first edit (hot path) is ≤300 ms</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 9.4: Performance Budget - Time to First Edit (Cold Path)</h4>
          <p>Verify that opening a snippet not yet loaded and starting to type is acceptable (≤1.5 s from click to first character appearing, includes Drive fetch).</p>
          <div class="test-steps">
            <ol>
              <li>Open a story with many snippets</li>
              <li>Find a snippet that hasn't been loaded yet (not in cache)</li>
              <li>Click on the snippet to open it in the editor</li>
              <li>Start typing immediately</li>
              <li>Measure time from click to first character appearing (use browser dev tools or stopwatch)</li>
              <li>Verify latency is ≤1.5 s (cold path - includes Drive fetch)</li>
              <li>Repeat with several different unloaded snippets</li>
              <li>Verify all meet the performance budget</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-8-4" name="test-8-4">
            <label for="test-8-4">Time to first edit (cold path) is ≤1.5 s</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 9.5: Performance Budget - Time to Switch Snippet (Hot Path)</h4>
          <p>Verify that switching to a snippet already in cache is fast (≤300 ms from click to editor ready).</p>
          <div class="test-steps">
            <ol>
              <li>Open a story and load multiple snippets (ensure they're in cache)</li>
              <li>Click on a snippet that's already been loaded</li>
              <li>Measure time from click to editor ready (content visible and editable)</li>
              <li>Verify latency is ≤300 ms (hot path - snippet already in cache)</li>
              <li>Switch between several cached snippets</li>
              <li>Verify all meet the performance budget</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-8-5" name="test-8-5">
            <label for="test-8-5">Time to switch snippet (hot path) is ≤300 ms</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 9.6: Performance Budget - Time to Switch Snippet (Cold Path)</h4>
          <p>Verify that switching to a snippet not yet loaded is acceptable (≤1.5 s from click to editor ready, includes Drive fetch).</p>
          <div class="test-steps">
            <ol>
              <li>Open a story with many snippets</li>
              <li>Find a snippet that hasn't been loaded yet (not in cache)</li>
              <li>Click on the snippet to switch to it</li>
              <li>Measure time from click to editor ready (content visible and editable)</li>
              <li>Verify latency is ≤1.5 s (cold path - includes Drive fetch)</li>
              <li>Switch to several different unloaded snippets</li>
              <li>Verify all meet the performance budget</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-8-6" name="test-8-6">
            <label for="test-8-6">Time to switch snippet (cold path) is ≤1.5 s</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 9.7: Special Characters & Round-Trip Preservation</h4>
          <p>Verify that special characters (quotes, em dashes, etc.) are preserved correctly in round-trips between Yarny and Google Docs.</p>
          <div class="test-steps">
            <ol>
              <li>Type special characters in a snippet: "quotes", 'apostrophes', —em dashes, –en dashes, …ellipses, ©copyright, ®registered, ™trademark</li>
              <li>Save the snippet in Yarny</li>
              <li>Open the Google Doc in Google Drive</li>
              <li>Verify all special characters are preserved exactly</li>
              <li>Edit in Google Docs and add more special characters: curly quotes "like this" and 'this'</li>
              <li>Save in Google Docs</li>
              <li>In Yarny, switch to a different snippet and switch back</li>
              <li>Verify all special characters are preserved in the round-trip</li>
              <li>Edit in Yarny again and add more special characters</li>
              <li>Save and verify in Google Docs that all characters are preserved</li>
              <li>Verify no characters are corrupted or changed during round-trips</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-8-7" name="test-8-7">
            <label for="test-8-7">Special characters are preserved correctly in round-trips</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 9.8: Long Text</h4>
          <p>Verify that the editor handles long text (10,000+ words) without issues.</p>
          <div class="test-steps">
            <ol>
              <li>Open or create a snippet with very long text (10,000+ words)</li>
              <li>Verify the editor displays all text</li>
              <li>Scroll through the text</li>
              <li>Verify scrolling is smooth</li>
              <li>Edit text in the middle</li>
              <li>Verify edits work correctly</li>
              <li>Save the snippet</li>
              <li>Verify it saves successfully</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-8-8" name="test-8-8">
            <label for="test-8-8">Editor handles long text without issues</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 9.9: Empty States</h4>
          <p>Verify that empty states (no stories, no chapters, no snippets) display correctly.</p>
          <div class="test-steps">
            <ol>
              <li>If you have no stories, verify the empty state message appears</li>
              <li>Create a story but don't add chapters</li>
              <li>Verify the editor shows appropriate empty state or message</li>
              <li>Add a chapter but don't add snippets</li>
              <li>Verify appropriate empty state or message appears</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-8-9" name="test-8-9">
            <label for="test-8-9">Empty states display correctly</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Test 9.10: Offline/Spotty-Network Semantics</h4>
          <p>Verify that the app handles offline and spotty network conditions gracefully with clear user feedback.</p>
          <div class="test-steps">
            <ol>
              <li><strong>Go offline</strong>: Disable network (or use browser dev tools to simulate offline)</li>
              <li>Edit a snippet while offline</li>
              <li>Verify editor remains editable (you can continue typing)</li>
              <li><strong>Offline banner</strong>: Verify offline banner appears at top of editor (non-blocking, dismissible)</li>
              <li>Verify banner message says "You're offline. Changes will be saved when connection is restored."</li>
              <li><strong>Queued save</strong>: Verify save status shows "Queued - will save when online" (no timestamp)</li>
              <li>Make multiple edits while offline</li>
              <li><strong>Reconnect</strong>: Re-enable network</li>
              <li>Verify queued saves automatically retry and complete</li>
              <li><strong>Save status on reconnect</strong>: Verify "Saved at X:XX" appears after successful save</li>
              <li><strong>Stale cache warning</strong>: Go offline again → Wait 5+ minutes → Verify "Using cached data" or "Last synced: X:XX" warning appears</li>
              <li><strong>Network flapping</strong>: Rapidly toggle network on/off multiple times → Verify save queue handles multiple toggles correctly, no data loss</li>
              <li><strong>Retry exhaustion</strong>: Simulate network error with no retries remaining → Verify mutation is queued (not lost), shows queued status</li>
              <li><strong>Multiple queued saves</strong>: Go offline → Make multiple edits to different snippets → Reconnect → Verify all saves complete in order</li>
              <li><strong>Cache staleness</strong>: Load a snippet → Go offline → Wait 10+ minutes → Verify "Last synced: X:XX" appears instead of "Saved at X:XX"</li>
              <li>Verify editor remains editable even with stale cache (but shows warning)</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="test-8-10" name="test-8-10">
            <label for="test-8-10">App handles offline/spotty-network conditions gracefully with clear feedback</label>
          </div>
        </div>
      </div>

        <!-- Section 1: Smoke Tests & Infrastructure Verification -->
        <div class="test-section" id="section-1">
          <h2><i class="material-icons">build</i> Section 1: Smoke Tests & Infrastructure Verification</h2>
          <p style="color: rgba(255, 255, 255, 0.7); margin-bottom: var(--space-lg);">These tests validate the setup, infrastructure, and critical functionality before and during development. These should be executed early and re-verified after major changes.</p>
        
        <div class="test-item">
          <h4>Smoke Test 1.1: Local Development Setup</h4>
          <p>Verify that the development environment is set up correctly and the app runs locally.</p>
          <div class="test-steps">
            <ol>
              <li>Run <code>npm run dev</code> in the project root</li>
              <li>Verify the Vite dev server launches successfully</li>
              <li>Open the app in your browser (usually <code>http://localhost:5173</code>)</li>
              <li>Verify the Yarny React shell renders correctly</li>
              <li>Verify project and story side rails render placeholder Drive data from <code>createDriveClient</code> fallback</li>
              <li>Authenticate with Google (if required)</li>
              <li>Select a story from the list</li>
              <li>Verify the TipTap plain text editor loads with sample content</li>
              <li>Verify the editor is editable and responsive</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="smoke-9-1" name="smoke-9-1">
            <label for="smoke-9-1">Local development environment works correctly</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Smoke Test 1.2: Build & Lint</h4>
          <p>Verify that the project builds successfully and passes linting checks.</p>
          <div class="test-steps">
            <ol>
              <li>Run <code>npm run build</code> in the project root</li>
              <li>Verify the build completes without errors</li>
              <li>Verify a <code>dist/</code> folder is created containing the React bundle</li>
              <li>Run <code>npm run lint</code></li>
              <li>Verify linting executes without fatal errors</li>
              <li>Fix any critical linting errors (warnings are acceptable)</li>
              <li>Run <code>npm run test</code></li>
              <li>Verify the default Vitest suite passes</li>
              <li>Note any test failures that need to be addressed</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="smoke-9-2" name="smoke-9-2">
            <label for="smoke-9-2">Build, lint, and test commands execute successfully</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Smoke Test 1.3: Netlify Functions & Deployment</h4>
          <p>Verify that Netlify Functions work correctly and deployment succeeds.</p>
          <div class="test-steps">
            <ol>
              <li>Run <code>netlify dev</code> in the project root</li>
              <li>Verify Netlify Functions start successfully</li>
              <li>Test a few API endpoints (e.g., <code>/api/config</code>, <code>/api/verify-google</code>)</li>
              <li>Verify functions return expected responses</li>
              <li>Check Netlify dashboard for environment variables:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Verify <code>GDRIVE_CLIENT_ID</code> is set</li>
                  <li>Verify <code>GDRIVE_CLIENT_SECRET</code> is set</li>
                  <li>Verify <code>GOOGLE_CLIENT_ID</code> is set</li>
                  <li>Verify <code>VITE_TEST_CORPUS_FOLDER_ID</code> is set (if using test corpus)</li>
                </ul>
              </li>
              <li>Run <code>netlify deploy --build</code> (or verify CI/CD deployment)</li>
              <li>Verify deployment completes successfully</li>
              <li>Verify the deployed site loads correctly</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="smoke-9-3" name="smoke-9-3">
            <label for="smoke-9-3">Netlify Functions and deployment work correctly</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Smoke Test 1.4: Editor Plain Text Discipline</h4>
          <p>Verify that the editor only supports plain text and preserves formatting correctly.</p>
          <div class="test-steps">
            <ol>
              <li>Open a snippet in the editor</li>
              <li>Verify the TipTap toolbar is hidden (no formatting buttons visible)</li>
              <li>Verify only plain text input is available</li>
              <li>Try keyboard shortcuts for formatting (Ctrl+B, Ctrl+I, Ctrl+U) - they should NOT work</li>
              <li>Open a Google Doc with formatted text (bold, italic, colors, etc.)</li>
              <li>Copy text from the Google Doc</li>
              <li>Paste into the Yarny editor</li>
              <li>Verify formatting is stripped and only plain text remains</li>
              <li>Verify paragraph breaks (double Enter) are preserved</li>
              <li>Verify hard breaks (Shift+Enter) are preserved</li>
              <li>Save the snippet</li>
              <li>Open the snippet's Google Doc in Google Drive</li>
              <li>Verify paragraph breaks and hard breaks are preserved correctly</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="smoke-9-4" name="smoke-9-4">
            <label for="smoke-9-4">Editor enforces plain text discipline and preserves breaks</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Smoke Test 1.5: State Management</h4>
          <p>Verify that Zustand store initializes correctly and React Query cache invalidation works.</p>
          <div class="test-steps">
            <ol>
              <li>Open the app in development mode</li>
              <li>Open browser DevTools console</li>
              <li>Verify no runtime warnings appear about Zustand store initialization</li>
              <li>Verify the store initializes without errors in React strict mode</li>
              <li>Install React Query DevTools (if not already installed):
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Add <code>import { ReactQueryDevtools } from '@tanstack/react-query-devtools'</code> to your app</li>
                  <li>Add <code>&lt;ReactQueryDevtools initialIsOpen={false} /&gt;</code> to your app component</li>
                </ul>
              </li>
              <li>Open React Query DevTools in the browser</li>
              <li>Make an edit to a snippet</li>
              <li>Manually save the snippet (or wait for auto-save)</li>
              <li>Verify query cache invalidation occurs (check DevTools for cache updates)</li>
              <li>Verify the UI updates reflect the saved changes</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="smoke-9-5" name="smoke-9-5">
            <label for="smoke-9-5">State management and cache invalidation work correctly</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Smoke Test 1.6: Create Operations</h4>
          <p>Verify that all create operations work correctly (stories, chapters, snippets, notes).</p>
          <div class="test-steps">
            <ol>
              <li>Create a new story:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Click "New Story" button</li>
                  <li>Enter a story name</li>
                  <li>Optionally set a goal</li>
                  <li>Click "Create"</li>
                  <li>Verify the story appears in the list</li>
                  <li>Verify the story folder is created in Google Drive</li>
                </ul>
              </li>
              <li>Create a new chapter:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Right-click on the story or use context menu</li>
                  <li>Select "New Chapter"</li>
                  <li>Enter a chapter name</li>
                  <li>Verify the chapter appears in the sidebar</li>
                  <li>Verify the chapter folder is created in Google Drive</li>
                </ul>
              </li>
              <li>Create a new snippet:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Right-click on a chapter or use context menu</li>
                  <li>Select "New Snippet"</li>
                  <li>Enter a snippet name</li>
                  <li>Verify the snippet appears in the sidebar</li>
                  <li>Verify the snippet Google Doc is created in Google Drive</li>
                </ul>
              </li>
              <li>Create a new note (People, Places, or Things):
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Open the Notes sidebar</li>
                  <li>Click "New People" (or Places/Things)</li>
                  <li>Enter a note name</li>
                  <li>Verify the note appears in the sidebar</li>
                  <li>Verify the note text file is created in Google Drive</li>
                </ul>
              </li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="smoke-9-6" name="smoke-9-6">
            <label for="smoke-9-6">All create operations work correctly</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Smoke Test 1.7: Rename Operations</h4>
          <p>Verify that all rename operations work correctly and persist to Google Drive.</p>
          <div class="test-steps">
            <ol>
              <li>Rename a story:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Right-click on a story</li>
                  <li>Select "Rename"</li>
                  <li>Enter a new name</li>
                  <li>Verify the story name updates in the UI</li>
                  <li>Verify the story folder is renamed in Google Drive</li>
                </ul>
              </li>
              <li>Rename a chapter:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Right-click on a chapter</li>
                  <li>Select "Rename"</li>
                  <li>Enter a new name</li>
                  <li>Verify the chapter name updates in the UI</li>
                  <li>Verify the chapter folder is renamed in Google Drive</li>
                </ul>
              </li>
              <li>Rename a snippet:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Right-click on a snippet</li>
                  <li>Select "Rename"</li>
                  <li>Enter a new name</li>
                  <li>Verify the snippet name updates in the UI</li>
                  <li>Verify the snippet Google Doc is renamed in Google Drive</li>
                </ul>
              </li>
              <li>Rename a note:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Right-click on a note</li>
                  <li>Select "Rename"</li>
                  <li>Enter a new name</li>
                  <li>Verify the note name updates in the UI</li>
                  <li>Verify the note text file is renamed in Google Drive</li>
                </ul>
              </li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="smoke-9-7" name="smoke-9-7">
            <label for="smoke-9-7">All rename operations work correctly</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Smoke Test 1.8: Reorder Operations</h4>
          <p>Verify that drag & drop reordering works correctly and persists to Google Drive.</p>
          <div class="test-steps">
            <ol>
              <li>Reorder chapters:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Drag a chapter up or down in the sidebar</li>
                  <li>Release to drop it in a new position</li>
                  <li>Verify the chapter moves to the new position</li>
                  <li>Refresh the page</li>
                  <li>Verify the chapter order is preserved</li>
                </ul>
              </li>
              <li>Reorder snippets:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Drag a snippet up or down within a chapter</li>
                  <li>Release to drop it in a new position</li>
                  <li>Verify the snippet moves to the new position</li>
                  <li>Refresh the page</li>
                  <li>Verify the snippet order is preserved</li>
                </ul>
              </li>
              <li>Move snippet between chapters:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Drag a snippet from one chapter to another</li>
                  <li>Release to drop it in the new chapter</li>
                  <li>Verify the snippet moves to the new chapter</li>
                  <li>Verify the snippet disappears from the old chapter</li>
                  <li>Verify the snippet Google Doc is moved in Google Drive</li>
                </ul>
              </li>
              <li>Reorder notes:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Drag a note up or down in the Notes sidebar</li>
                  <li>Release to drop it in a new position</li>
                  <li>Verify the note moves to the new position</li>
                  <li>Refresh the page</li>
                  <li>Verify the note order is preserved</li>
                </ul>
              </li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="smoke-9-8" name="smoke-9-8">
            <label for="smoke-9-8">All reorder operations work correctly</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Smoke Test 1.9: Edit Operations</h4>
          <p>Verify that editing snippets and notes works correctly and auto-saves to Google Drive.</p>
          <div class="test-steps">
            <ol>
              <li>Edit a snippet:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Open a snippet in the editor</li>
                  <li>Type some text</li>
                  <li>Verify the word count updates in real-time</li>
                  <li>Wait for auto-save (check save status indicator)</li>
                  <li>Verify "Saved at X:XX" appears after save</li>
                  <li>Open the snippet's Google Doc in Google Drive</li>
                  <li>Verify your changes appear in the Google Doc</li>
                </ul>
              </li>
              <li>Edit a note:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Open a note in the Notes sidebar</li>
                  <li>Edit the note content</li>
                  <li>Wait for auto-save</li>
                  <li>Verify the note text file is updated in Google Drive</li>
                </ul>
              </li>
              <li>Test undo/redo (if available):
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Make an edit</li>
                  <li>Press Ctrl+Z (or Cmd+Z) to undo</li>
                  <li>Verify the change is undone</li>
                  <li>Press Ctrl+Shift+Z (or Cmd+Shift+Z) to redo</li>
                  <li>Verify the change is redone</li>
                </ul>
              </li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="smoke-9-9" name="smoke-9-9">
            <label for="smoke-9-9">All edit operations work correctly with auto-save</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Smoke Test 1.10: Export Operations</h4>
          <p>Verify that all export operations work correctly and create Google Docs in Drive.</p>
          <div class="test-steps">
            <ol>
              <li>Export all chapters:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Click "Export" and select "Export All Chapters"</li>
                  <li>Enter a filename</li>
                  <li>Optionally choose to include snippet names</li>
                  <li>Click "Export"</li>
                  <li>Verify a new Google Doc is created in the story folder</li>
                  <li>Open the exported Google Doc</li>
                  <li>Verify all chapters and snippets are included in order</li>
                </ul>
              </li>
              <li>Export outline:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Click "Export" and select "Export Outline"</li>
                  <li>Enter a filename</li>
                  <li>Click "Export"</li>
                  <li>Verify a new Google Doc is created</li>
                  <li>Verify it contains chapter titles, snippet titles, and descriptions</li>
                  <li>Verify it does NOT contain snippet body content</li>
                </ul>
              </li>
              <li>Export notes (People, Places, Things):
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Export each note type separately</li>
                  <li>Verify exported Google Docs contain all notes of that type</li>
                  <li>Verify note content is included correctly</li>
                </ul>
              </li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="smoke-9-10" name="smoke-9-10">
            <label for="smoke-9-10">All export operations work correctly</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Smoke Test 1.11: Conflict Resolution (Concurrency Safety)</h4>
          <p>Verify that conflict detection and resolution work correctly when multiple editors modify the same content.</p>
          <div class="test-steps">
            <ol>
              <li>Open Yarny in two browser tabs (Tab 1 and Tab 2)</li>
              <li>In Tab 1, open a snippet and make an edit</li>
              <li>Save the snippet in Tab 1</li>
              <li>In Tab 2, open the same snippet (make it idle, not actively editing)</li>
              <li>In another browser tab, open the snippet's Google Doc in Google Docs</li>
              <li>Make different edits in Google Docs</li>
              <li>Save in Google Docs</li>
              <li>In Tab 2, switch back to the snippet</li>
              <li>Verify a conflict resolution modal appears</li>
              <li>Verify you can see both versions (Yarny vs Google Docs)</li>
              <li>Choose "Keep Yarny Version" and verify it works</li>
              <li>Trigger another conflict</li>
              <li>Choose "Use Google Docs Version" and verify it works</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="smoke-9-11" name="smoke-9-11">
            <label for="smoke-9-11">Conflict resolution works correctly</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Smoke Test 1.12: Round-Trip Testing (Round-Trip Integrity)</h4>
          <p>Verify that content can be edited in both Yarny and Google Docs with no data loss or format corruption.</p>
          <div class="test-steps">
            <ol>
              <li>Edit a snippet in Yarny with special characters (quotes, em dashes, etc.)</li>
              <li>Add paragraph breaks (double Enter) and line breaks (Shift+Enter)</li>
              <li>Save the snippet in Yarny</li>
              <li>Open the snippet's Google Doc in Google Docs</li>
              <li>Verify all content matches exactly (paragraph breaks, line breaks, special characters)</li>
              <li>Edit in Google Docs (add text, modify existing text)</li>
              <li>Save in Google Docs</li>
              <li>In Yarny, switch to a different snippet and switch back</li>
              <li>Verify Yarny detects the external changes</li>
              <li>Verify all content is preserved correctly (no format loss, no corruption)</li>
              <li>Edit in Yarny again</li>
              <li>Save and verify in Google Docs that all changes are preserved</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="smoke-9-12" name="smoke-9-12">
            <label for="smoke-9-12">Round-trip editing preserves all content correctly</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Smoke Test 1.13: Performance & Loading</h4>
          <p>Verify that the app performs well with large projects and loads content efficiently.</p>
          <div class="test-steps">
            <ol>
              <li>Open a large story (use test-large project if available):
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Verify the app loads in a reasonable time (&lt; 5 seconds)</li>
                  <li>Verify scrolling through chapters/snippets is smooth</li>
                  <li>Verify snippet switching is responsive</li>
                </ul>
              </li>
              <li>Test lazy loading:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Open a story with many snippets</li>
                  <li>Verify the active snippet loads immediately</li>
                  <li>Check browser network tab</li>
                  <li>Verify other snippets load in the background (lazy loading)</li>
                  <li>Switch to a different snippet</li>
                  <li>Verify it loads quickly (may be from cache if already loaded)</li>
                </ul>
              </li>
              <li>Test performance budgets:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Open a snippet already in cache</li>
                  <li>Click on it and start typing immediately</li>
                  <li>Measure time from click to first character appearing</li>
                  <li>Verify latency is ≤300 ms (hot path)</li>
                  <li>Open a snippet not yet loaded</li>
                  <li>Measure time from click to first character appearing</li>
                  <li>Verify latency is ≤1.5 s (cold path)</li>
                </ul>
              </li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="smoke-9-13" name="smoke-9-13">
            <label for="smoke-9-13">Performance and loading meet requirements</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Smoke Test 1.14: Error Handling & Rate Limiting</h4>
          <p>Verify that the app handles errors gracefully and respects Drive API rate limits.</p>
          <div class="test-steps">
            <ol>
              <li>Test offline handling:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Disable network (or use browser dev tools)</li>
                  <li>Make an edit to a snippet</li>
                  <li>Verify offline banner appears</li>
                  <li>Verify save status shows "Queued - will save when online"</li>
                  <li>Re-enable network</li>
                  <li>Verify queued saves automatically retry and complete</li>
                </ul>
              </li>
              <li>Test error messages:
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Trigger an error (e.g., invalid file ID, network error)</li>
                  <li>Verify a clear error message appears</li>
                  <li>Verify you can retry the action if applicable</li>
                </ul>
              </li>
              <li>Test rate limiting (if possible):
                <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                  <li>Make rapid requests (or simulate 429 error)</li>
                  <li>Verify exponential backoff is applied</li>
                  <li>Verify retry only happens when tab is visible</li>
                  <li>Verify a clear error message is displayed</li>
                  <li>Verify automatic retry happens after backoff delay</li>
                </ul>
              </li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="smoke-9-14" name="smoke-9-14">
            <label for="smoke-9-14">Error handling and rate limiting work correctly</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Smoke Test 1.15: Cross-Tab Conflicts (Yarny vs. Yarny)</h4>
          <p>Verify that Yarny detects and prevents conflicts when the same snippet is edited in multiple tabs.</p>
          <div class="test-steps">
            <ol>
              <li>Open Yarny in two browser tabs (Tab 1 and Tab 2)</li>
              <li>In Tab 1, open a snippet and start editing</li>
              <li>In Tab 2, try to open the same snippet</li>
              <li>Verify Tab 2 shows "Editing in another tab" message or read-only indicator</li>
              <li>Verify Tab 2 is read-only (cannot edit) while Tab 1 is editing</li>
              <li>Save the snippet in Tab 1</li>
              <li>Switch to Tab 2</li>
              <li>Verify Tab 2 updates with the latest content from Tab 1</li>
              <li>Close Tab 1</li>
              <li>Verify Tab 2 regains edit capability (no longer read-only)</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="smoke-9-15" name="smoke-9-15">
            <label for="smoke-9-15">Cross-tab conflict detection works correctly</label>
          </div>
        </div>

        <div class="test-item">
          <h4>Smoke Test 1.16: Visibility-Based Request Gating</h4>
          <p>Verify that Yarny only makes background requests when the browser tab is visible.</p>
          <div class="test-steps">
            <ol>
              <li>Open Yarny in multiple browser tabs</li>
              <li>Open a story with many snippets in Tab 1</li>
              <li>Switch to Tab 2 (Tab 1 becomes hidden)</li>
              <li>Check browser network tab or console</li>
              <li>Verify Tab 1 stops making background prefetch requests when hidden</li>
              <li>Switch back to Tab 1 (tab becomes visible)</li>
              <li>Verify background prefetch requests resume in Tab 1</li>
              <li>Verify only the visible tab makes background requests</li>
            </ol>
          </div>
          <div class="checkbox-container">
            <input type="checkbox" id="smoke-9-16" name="smoke-9-16">
            <label for="smoke-9-16">Visibility-based request gating works correctly</label>
          </div>
        </div>

        <div class="note-box" style="margin-top: var(--space-2xl);">
          <p><strong>Smoke Test Execution:</strong> These smoke tests should be executed:</p>
          <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl); color: rgba(255, 255, 255, 0.9);">
            <li><strong>Before Phase 2:</strong> Tests 9.1-9.5 (Local Development, Build, Netlify, Editor, State Management)</li>
            <li><strong>After Phase 4:</strong> Tests 9.6-9.10 (Create, Rename, Reorder, Edit, Export)</li>
            <li><strong>After Phase 5:</strong> Tests 9.11-9.12 (Conflict Resolution, Round-Trip)</li>
            <li><strong>After Phase 6:</strong> Tests 9.13-9.16 (Performance, Error Handling, Cross-Tab, Visibility Gating)</li>
            <li><strong>Before Ship:</strong> Re-execute all smoke tests to verify no regressions</li>
          </ul>
        </div>
      </div>

        <!-- Section 10: Round-Trip Validation (Final comprehensive test) -->
        <div class="test-section" id="section-10">
          <h2><i class="material-icons">sync</i> Section 10: Round-Trip Validation (test-small Project)</h2>
          <p style="color: rgba(255, 255, 255, 0.7); margin-bottom: var(--space-lg);">This is the comprehensive end-to-end validation that ensures round-trip integrity between Yarny and Google Docs using the test-small project. Complete this section last, after all other sections. This ensures content is preserved correctly in both directions with no data loss or format corruption.</p>
        
          <div class="note-box" style="margin-bottom: var(--space-xl);">
            <p><strong>Prerequisites:</strong> Before starting validation, ensure:</p>
            <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl); color: rgba(255, 255, 255, 0.9);">
              <li>Yarny Test Corpus folder exists in Google Drive</li>
              <li>test-small story folder created in the corpus folder</li>
              <li>Story structure created (Chapters/, People/, Places/, Things/ folders)</li>
              <li>"Welcome to Yarny" and "Character Seeds" snippets uploaded as Google Docs</li>
              <li>Story folder ID recorded in <code>test-corpus/sample-project/metadata.json</code></li>
              <li>Yarny app is running and user is authenticated with Google</li>
              <li>test-small story is accessible in Yarny stories list</li>
            </ul>
          </div>

          <div class="test-item">
            <h4>Test 10.1: Basic Content Round-Trip (Yarny → Google Docs → Yarny)</h4>
            <p>Verify that basic text content is preserved correctly in a round-trip.</p>
            <div class="test-steps">
              <ol>
                <li>Open the test-small story in Yarny</li>
                <li>Open the "Welcome to Yarny" snippet in the editor</li>
                <li><strong>Record initial content</strong> - Copy the entire content from Yarny editor</li>
                <li><strong>Save in Yarny</strong> - Wait for auto-save to complete (check save status)</li>
                <li><strong>Open in Google Docs</strong> - Open the snippet's Google Doc in Google Drive</li>
                <li><strong>Verify content matches</strong> - Compare Google Docs content with recorded Yarny content:
                  <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                    <li>All text matches exactly</li>
                    <li>No characters are missing</li>
                    <li>No characters are added</li>
                    <li>No characters are corrupted</li>
                  </ul>
                </li>
                <li><strong>Edit in Google Docs</strong> - Add a new paragraph: "This is a test edit from Google Docs."</li>
                <li><strong>Save in Google Docs</strong> - Save the document</li>
                <li><strong>Return to Yarny</strong> - Switch to a different snippet, then switch back to "Welcome to Yarny"</li>
                <li><strong>Verify changes appear</strong> - Check that the edit from Google Docs appears in Yarny</li>
                <li><strong>Verify content integrity</strong> - Compare full content again:
                  <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                    <li>All original content is preserved</li>
                    <li>New edit from Google Docs is present</li>
                    <li>No format loss or corruption</li>
                  </ul>
                </li>
              </ol>
            </div>
            <div class="checkbox-container">
              <input type="checkbox" id="roundtrip-10-1" name="roundtrip-10-1">
              <label for="roundtrip-10-1">Basic content round-trip preserves all content correctly</label>
            </div>
          </div>

          <div class="test-item">
            <h4>Test 10.2: Paragraph Breaks Round-Trip</h4>
            <p>Verify that paragraph breaks (double Enter) are preserved correctly.</p>
            <div class="test-steps">
              <ol>
                <li>Open "Welcome to Yarny" snippet in Yarny</li>
                <li><strong>Add paragraph breaks</strong> - Add multiple paragraph breaks:
                  <pre style="background: rgba(0, 0, 0, 0.3); padding: var(--space-md); border-radius: 4px; margin: var(--space-sm) 0;">First paragraph.

Second paragraph.

Third paragraph.</pre>
                </li>
                <li><strong>Save in Yarny</strong> - Wait for auto-save</li>
                <li><strong>Open in Google Docs</strong> - Open the snippet's Google Doc</li>
                <li><strong>Verify paragraph breaks</strong> - Check that paragraph breaks are preserved:
                  <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                    <li>Each paragraph is on a separate line with spacing</li>
                    <li>No paragraph breaks are collapsed (merged)</li>
                    <li>No paragraph breaks are duplicated</li>
                  </ul>
                </li>
                <li><strong>Edit in Google Docs</strong> - Add another paragraph: "Fourth paragraph added in Google Docs."</li>
                <li><strong>Save in Google Docs</strong></li>
                <li><strong>Return to Yarny</strong> - Switch snippets and switch back</li>
                <li><strong>Verify paragraph breaks preserved</strong> - Check that all paragraph breaks are still correct:
                  <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                    <li>Original paragraph breaks are preserved</li>
                    <li>New paragraph from Google Docs has proper spacing</li>
                    <li>No paragraph breaks are collapsed or duplicated</li>
                  </ul>
                </li>
              </ol>
            </div>
            <div class="checkbox-container">
              <input type="checkbox" id="roundtrip-10-2" name="roundtrip-10-2">
              <label for="roundtrip-10-2">Paragraph breaks are preserved exactly in both directions</label>
            </div>
          </div>

          <div class="test-item">
            <h4>Test 10.3: Line Breaks Round-Trip</h4>
            <p>Verify that soft line breaks (Shift+Enter) are preserved correctly.</p>
            <div class="test-steps">
              <ol>
                <li>Open "Welcome to Yarny" snippet in Yarny</li>
                <li><strong>Add line breaks</strong> - Add soft line breaks within a paragraph (Use Shift+Enter for line breaks, not Enter):
                  <pre style="background: rgba(0, 0, 0, 0.3); padding: var(--space-md); border-radius: 4px; margin: var(--space-sm) 0;">Line one
Line two
Line three</pre>
                </li>
                <li><strong>Save in Yarny</strong> - Wait for auto-save</li>
                <li><strong>Open in Google Docs</strong> - Open the snippet's Google Doc</li>
                <li><strong>Verify line breaks</strong> - Check that line breaks are preserved:
                  <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                    <li>Each line is on a separate line</li>
                    <li>No line breaks are collapsed</li>
                    <li>No line breaks are converted to paragraph breaks</li>
                  </ul>
                </li>
                <li><strong>Edit in Google Docs</strong> - Add another line: "Line four added in Google Docs"</li>
                <li><strong>Save in Google Docs</strong></li>
                <li><strong>Return to Yarny</strong> - Switch snippets and switch back</li>
                <li><strong>Verify line breaks preserved</strong> - Check that all line breaks are still correct</li>
              </ol>
            </div>
            <div class="checkbox-container">
              <input type="checkbox" id="roundtrip-10-3" name="roundtrip-10-3">
              <label for="roundtrip-10-3">Line breaks are preserved exactly in both directions</label>
            </div>
          </div>

          <div class="test-item">
            <h4>Test 10.4: Special Characters Round-Trip</h4>
            <p>Verify that special characters are preserved correctly.</p>
            <div class="test-steps">
              <ol>
                <li>Open "Welcome to Yarny" snippet in Yarny</li>
                <li><strong>Add special characters</strong> - Add various special characters:
                  <pre style="background: rgba(0, 0, 0, 0.3); padding: var(--space-md); border-radius: 4px; margin: var(--space-sm) 0;">Quotes: "double" and 'single'
Em dash: —
En dash: –
Ellipsis: …
Copyright: ©
Registered: ®
Trademark: ™</pre>
                </li>
                <li><strong>Save in Yarny</strong> - Wait for auto-save</li>
                <li><strong>Open in Google Docs</strong> - Open the snippet's Google Doc</li>
                <li><strong>Verify special characters</strong> - Check that all special characters are preserved:
                  <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                    <li>Double quotes are preserved</li>
                    <li>Single quotes are preserved</li>
                    <li>Em dash (—) is preserved</li>
                    <li>En dash (–) is preserved</li>
                    <li>Ellipsis (…) is preserved</li>
                    <li>Copyright (©) is preserved</li>
                    <li>Registered (®) is preserved</li>
                    <li>Trademark (™) is preserved</li>
                  </ul>
                </li>
                <li><strong>Edit in Google Docs</strong> - Add more special characters: "Curly quotes: "like this" and 'this'"</li>
                <li><strong>Save in Google Docs</strong></li>
                <li><strong>Return to Yarny</strong> - Switch snippets and switch back</li>
                <li><strong>Verify all special characters preserved</strong> - Check that all characters are still correct</li>
              </ol>
            </div>
            <div class="checkbox-container">
              <input type="checkbox" id="roundtrip-10-4" name="roundtrip-10-4">
              <label for="roundtrip-10-4">All special characters are preserved exactly in both directions</label>
            </div>
          </div>

          <div class="test-item">
            <h4>Test 10.5: Mixed Formatting Round-Trip</h4>
            <p>Verify that mixed paragraph breaks, line breaks, and special characters all work together.</p>
            <div class="test-steps">
              <ol>
                <li>Open "Character Seeds" snippet in Yarny</li>
                <li><strong>Create complex content</strong> - Add content with multiple paragraph breaks, line breaks within paragraphs, and special characters:
                  <pre style="background: rgba(0, 0, 0, 0.3); padding: var(--space-md); border-radius: 4px; margin: var(--space-sm) 0;">Character: John Doe

Description: A "mysterious" character with—wait for it—a secret past.

Traits:
- Brave
- Curious
- Loyal

Notes: He's been to many places… but never talks about them.</pre>
                </li>
                <li><strong>Save in Yarny</strong> - Wait for auto-save</li>
                <li><strong>Open in Google Docs</strong> - Open the snippet's Google Doc</li>
                <li><strong>Verify all formatting preserved</strong> - Check that:
                  <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                    <li>Paragraph breaks are correct</li>
                    <li>Line breaks are correct</li>
                    <li>Special characters are correct</li>
                    <li>Overall structure is preserved</li>
                  </ul>
                </li>
                <li><strong>Edit in Google Docs</strong> - Add more content with mixed formatting</li>
                <li><strong>Save in Google Docs</strong></li>
                <li><strong>Return to Yarny</strong> - Switch snippets and switch back</li>
                <li><strong>Verify complete round-trip</strong> - Check that all formatting is preserved correctly</li>
              </ol>
            </div>
            <div class="checkbox-container">
              <input type="checkbox" id="roundtrip-10-5" name="roundtrip-10-5">
              <label for="roundtrip-10-5">All formatting elements are preserved correctly in both directions</label>
            </div>
          </div>

          <div class="test-item">
            <h4>Test 10.6: Multiple Round-Trips</h4>
            <p>Verify that content integrity is maintained across multiple round-trips.</p>
            <div class="test-steps">
              <ol>
                <li>Open "Welcome to Yarny" snippet in Yarny</li>
                <li><strong>Record initial content</strong> - Copy the entire content</li>
                <li><strong>Round-trip 1</strong>: Edit in Yarny → Save → Edit in Google Docs → Save → Check in Yarny
                  <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                    <li>Content is preserved correctly</li>
                  </ul>
                </li>
                <li><strong>Round-trip 2</strong>: Edit in Yarny again → Save → Edit in Google Docs again → Save → Check in Yarny
                  <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                    <li>Content is preserved correctly</li>
                  </ul>
                </li>
                <li><strong>Round-trip 3</strong>: Edit in Google Docs → Save → Edit in Yarny → Save → Check in Google Docs
                  <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                    <li>Content is preserved correctly</li>
                  </ul>
                </li>
                <li><strong>Final verification</strong> - Compare final content with initial content:
                  <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                    <li>All original content is still present</li>
                    <li>All edits from both directions are present</li>
                    <li>No content is lost or corrupted</li>
                    <li>Formatting is preserved</li>
                  </ul>
                </li>
              </ol>
            </div>
            <div class="checkbox-container">
              <input type="checkbox" id="roundtrip-10-6" name="roundtrip-10-6">
              <label for="roundtrip-10-6">Content integrity is maintained across multiple round-trips</label>
            </div>
          </div>

          <div class="test-item">
            <h4>Test 10.7: Conflict Detection</h4>
            <p>Verify that conflicts are detected when both Yarny and Google Docs are edited.</p>
            <div class="test-steps">
              <ol>
                <li>Open "Welcome to Yarny" snippet in Yarny</li>
                <li><strong>Make edit in Yarny</strong> - Add: "Edit from Yarny"</li>
                <li><strong>Save in Yarny</strong> - Wait for auto-save</li>
                <li><strong>Switch to different snippet</strong> - Make the first snippet idle (not actively editing)</li>
                <li><strong>Edit in Google Docs</strong> - Open the snippet's Google Doc and add: "Edit from Google Docs"</li>
                <li><strong>Save in Google Docs</strong></li>
                <li><strong>Return to Yarny</strong> - Switch back to "Welcome to Yarny" snippet</li>
                <li><strong>Verify conflict detection</strong> - Check that:
                  <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                    <li>Conflict resolution modal appears</li>
                    <li>Both versions are displayed (Yarny vs Google Docs)</li>
                    <li>Timestamps are shown for both versions</li>
                  </ul>
                </li>
                <li><strong>Resolve with Yarny version</strong> - Choose "Keep Yarny Version"
                  <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                    <li>Yarny version is kept</li>
                    <li>Google Doc is updated with Yarny version</li>
                  </ul>
                </li>
                <li><strong>Verify in Google Docs</strong> - Open the Google Doc and verify it matches Yarny version</li>
                <li><strong>Test resolve with Google Docs version</strong> - Trigger another conflict and choose "Use Google Docs Version"
                  <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                    <li>Google Docs version replaces Yarny content</li>
                    <li>Editor shows Google Docs content</li>
                  </ul>
                </li>
              </ol>
            </div>
            <div class="checkbox-container">
              <input type="checkbox" id="roundtrip-10-7" name="roundtrip-10-7">
              <label for="roundtrip-10-7">Conflicts are detected and resolved correctly</label>
            </div>
          </div>

          <div class="test-item">
            <h4>Test 10.8: Empty Content Round-Trip</h4>
            <p>Verify that empty content is handled correctly.</p>
            <div class="test-steps">
              <ol>
                <li>Open "Character Seeds" snippet in Yarny</li>
                <li><strong>Clear all content</strong> - Delete all text (make snippet empty)</li>
                <li><strong>Save in Yarny</strong> - Wait for auto-save</li>
                <li><strong>Open in Google Docs</strong> - Open the snippet's Google Doc</li>
                <li><strong>Verify empty</strong> - Check that Google Doc is empty (or has minimal content)</li>
                <li><strong>Add content in Google Docs</strong> - Add: "Content added in Google Docs"</li>
                <li><strong>Save in Google Docs</strong></li>
                <li><strong>Return to Yarny</strong> - Switch snippets and switch back</li>
                <li><strong>Verify content appears</strong> - Check that content from Google Docs appears in Yarny</li>
              </ol>
            </div>
            <div class="checkbox-container">
              <input type="checkbox" id="roundtrip-10-8" name="roundtrip-10-8">
              <label for="roundtrip-10-8">Empty content is handled correctly, and new content from Google Docs appears</label>
            </div>
          </div>

          <div class="test-item">
            <h4>Test 10.9: Format Normalization</h4>
            <p>Verify that format normalization works correctly (line endings, NBSPs, trailing spaces).</p>
            <div class="test-steps">
              <ol>
                <li>Open "Welcome to Yarny" snippet in Yarny</li>
                <li><strong>Add content with mixed line endings</strong> - Create content with:
                  <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                    <li>Some lines ending with <code>\n</code> (Unix)</li>
                    <li>Some lines ending with <code>\r\n</code> (Windows)</li>
                    <li>Some lines ending with <code>\r</code> (Mac)</li>
                    <li>Non-breaking spaces (NBSP)</li>
                    <li>Trailing spaces</li>
                  </ul>
                </li>
                <li><strong>Save in Yarny</strong> - Wait for auto-save</li>
                <li><strong>Open in Google Docs</strong> - Open the snippet's Google Doc</li>
                <li><strong>Verify normalization</strong> - Check that:
                  <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                    <li>All line endings are normalized to <code>\n</code> (Unix format)</li>
                    <li>NBSPs are normalized to regular spaces</li>
                    <li>Trailing spaces are handled correctly</li>
                  </ul>
                </li>
                <li><strong>Edit in Google Docs</strong> - Add more content with mixed formatting</li>
                <li><strong>Save in Google Docs</strong></li>
                <li><strong>Return to Yarny</strong> - Switch snippets and switch back</li>
                <li><strong>Verify normalization after round-trip</strong> - Check that formatting is still normalized correctly</li>
              </ol>
            </div>
            <div class="checkbox-container">
              <input type="checkbox" id="roundtrip-10-9" name="roundtrip-10-9">
              <label for="roundtrip-10-9">Format normalization works correctly in both directions</label>
            </div>
          </div>

          <div class="test-item">
            <h4>Test 10.10: Auto-Save and Round-Trip</h4>
            <p>Verify that auto-save works correctly and content is preserved.</p>
            <div class="test-steps">
              <ol>
                <li>Open "Welcome to Yarny" snippet in Yarny</li>
                <li><strong>Make multiple edits</strong> - Type several sentences, wait for auto-save between edits</li>
                <li><strong>Check save status</strong> - Verify "Saved at X:XX" appears after each auto-save</li>
                <li><strong>Open in Google Docs</strong> - Open the snippet's Google Doc</li>
                <li><strong>Verify all edits saved</strong> - Check that all edits from Yarny appear in Google Docs</li>
                <li><strong>Edit in Google Docs</strong> - Make an edit in Google Docs</li>
                <li><strong>Save in Google Docs</strong></li>
                <li><strong>Return to Yarny</strong> - Switch snippets and switch back</li>
                <li><strong>Verify round-trip</strong> - Check that:
                  <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl);">
                    <li>All Yarny edits are preserved</li>
                    <li>Google Docs edit appears</li>
                    <li>Content is complete and correct</li>
                  </ul>
                </li>
              </ol>
            </div>
            <div class="checkbox-container">
              <input type="checkbox" id="roundtrip-10-10" name="roundtrip-10-10">
              <label for="roundtrip-10-10">Auto-save works correctly and round-trip preserves all content</label>
            </div>
          </div>

          <div class="note-box" style="margin-top: var(--space-2xl);">
            <p><strong>Round-Trip Validation Execution:</strong> These tests should be executed:</p>
            <ul style="margin-top: var(--space-sm); padding-left: var(--space-xl); color: rgba(255, 255, 255, 0.9);">
              <li><strong>After Phase 3:</strong> Complete all 10 round-trip validation tests with test-small project</li>
              <li><strong>Before Phase 4:</strong> Verify all tests pass before proceeding to editor phase</li>
              <li><strong>Document Results:</strong> Record any failures or issues in the notes section of each test</li>
              <li><strong>Report Issues:</strong> Create GitHub issues for any critical failures</li>
            </ul>
          </div>
        </div>

        <!-- Summary Section -->
        <div class="summary-section" id="summary">
          <h2>Testing Summary</h2>
        <p style="color: rgba(255, 255, 255, 0.8); margin-bottom: var(--space-xl);">Use this section to track your overall testing progress.</p>
        
        <div class="summary-stats">
          <div class="stat-box">
            <div class="stat-number" id="totalTests">0</div>
            <div class="stat-label">Total Tests</div>
          </div>
          <div class="stat-box">
            <div class="stat-number" id="completedTests">0</div>
            <div class="stat-label">Completed</div>
          </div>
          <div class="stat-box">
            <div class="stat-number" id="remainingTests">0</div>
            <div class="stat-label">Remaining</div>
          </div>
          <div class="stat-box">
            <div class="stat-number" id="completionPercent">0%</div>
            <div class="stat-label">Completion</div>
          </div>
        </div>
      </div>

        <div class="note-box" style="margin-top: var(--space-4xl);">
          <p><strong>Note:</strong> This testing workbook is designed to be comprehensive. You don't need to complete all tests in one session. Work through them systematically, and note any issues or unexpected behavior you encounter. Report any bugs or problems to the development team.</p>
        </div>
      </div>
    </main>

    <footer class="shared-footer">
      <p>&copy; 2025 Yarny. Your personal writing tool.</p>
      <nav class="shared-footer-nav">
        <a href="/docs.html">User Guide</a>
        <a href="/migration-plan">Migration Plan</a>
        <a href="/migration-plan/testing-workbook">Testing Workbook</a>
      </nav>
    </footer>
  </div>

  <script>
    // Check if user is logged in
    function isTokenExpired(token) {
      if (!token) return true;
      
      try {
        const decoded = atob(token);
        const parts = decoded.split(':');
        
        if (parts.length !== 2) return true;
        
        const timestamp = parseInt(parts[1], 10);
        if (isNaN(timestamp)) return true;
        
        // Check if token is within 48 hours
        const SESSION_DURATION_MS = 48 * 60 * 60 * 1000;
        const now = Date.now();
        const age = now - timestamp;
        
        return age > SESSION_DURATION_MS;
      } catch (error) {
        console.error('Error checking token expiration:', error);
        return true;
      }
    }

    function checkAuthStatus() {
      const authToken = localStorage.getItem('yarny_auth');
      const isLoggedIn = authToken && !isTokenExpired(authToken);
      
      const storiesLink = document.getElementById('storiesNavLink');
      const loginLink = document.getElementById('loginNavLink');
      
      if (isLoggedIn) {
        if (storiesLink) storiesLink.style.display = 'inline-block';
        if (loginLink) loginLink.style.display = 'none';
      } else {
        if (storiesLink) storiesLink.style.display = 'none';
        if (loginLink) loginLink.style.display = 'inline-block';
      }
    }

    // Calculate and update test statistics
    function updateStats() {
      const checkboxes = document.querySelectorAll('input[type="checkbox"]');
      const total = checkboxes.length;
      const completed = Array.from(checkboxes).filter(cb => cb.checked).length;
      const remaining = total - completed;
      const percent = total > 0 ? Math.round((completed / total) * 100) : 0;

      document.getElementById('totalTests').textContent = total;
      document.getElementById('completedTests').textContent = completed;
      document.getElementById('remainingTests').textContent = remaining;
      document.getElementById('completionPercent').textContent = percent + '%';
    }

    // Update stats when checkboxes change
    document.addEventListener('change', function(e) {
      if (e.target.type === 'checkbox') {
        updateStats();
        // Save state to localStorage
        localStorage.setItem('testingWorkbookState', JSON.stringify(
          Array.from(document.querySelectorAll('input[type="checkbox"]')).map(cb => ({
            id: cb.id,
            checked: cb.checked
          }))
        ));
      }
    });

    // Highlight active navigation item based on scroll position
    document.addEventListener('DOMContentLoaded', function() {
      // Check auth status on page load
      checkAuthStatus();
      
      // Load saved checkbox state
      const saved = localStorage.getItem('testingWorkbookState');
      if (saved) {
        try {
          const state = JSON.parse(saved);
          state.forEach(item => {
            const checkbox = document.getElementById(item.id);
            if (checkbox) {
              checkbox.checked = item.checked;
            }
          });
        } catch (e) {
          console.error('Error loading saved state:', e);
        }
      }
      updateStats();

      const navLinks = document.querySelectorAll('.sidebar-nav .nav-link');
      const sections = document.querySelectorAll('.test-section[id], .workbook-intro[id], .summary-section[id]');
      const sidebar = document.querySelector('.docs-sidebar');

      function updateActiveNav() {
        let current = '';
        const scrollPos = window.scrollY + 100; // Offset for nav buttons

        sections.forEach(section => {
          const sectionTop = section.offsetTop;
          const sectionHeight = section.offsetHeight;
          if (scrollPos >= sectionTop && scrollPos < sectionTop + sectionHeight) {
            current = section.getAttribute('id');
          }
        });

        navLinks.forEach(link => {
          link.classList.remove('active');
          if (link.getAttribute('href') === '#' + current) {
            link.classList.add('active');
          }
        });
      }

      // Mobile menu toggle
      const menuButton = document.querySelector('.mobile-menu-toggle') || document.createElement('button');
      const backdrop = document.querySelector('.sidebar-backdrop');
      
      if (!menuButton.parentNode) {
        menuButton.className = 'mobile-menu-toggle';
        menuButton.innerHTML = '☰';
        menuButton.setAttribute('aria-label', 'Toggle menu');
        document.body.appendChild(menuButton);
      }

      function toggleSidebar() {
        sidebar.classList.toggle('open');
        if (backdrop) {
          backdrop.classList.toggle('active');
        }
      }

      menuButton.addEventListener('click', function(e) {
        e.stopPropagation();
        toggleSidebar();
      });

      // Close sidebar when clicking backdrop
      if (backdrop) {
        backdrop.addEventListener('click', function() {
          sidebar.classList.remove('open');
          backdrop.classList.remove('active');
        });
      }

      // Close sidebar when clicking outside on mobile
      document.addEventListener('click', function(e) {
        if (window.innerWidth <= 900 && sidebar && sidebar.classList.contains('open')) {
          if (!sidebar.contains(e.target) && !e.target.classList.contains('mobile-menu-toggle')) {
            sidebar.classList.remove('open');
            if (backdrop) {
              backdrop.classList.remove('active');
            }
          }
        }
      });

      // Close sidebar when clicking a nav link on mobile
      navLinks.forEach(link => {
        link.addEventListener('click', function() {
          if (window.innerWidth <= 900) {
            sidebar.classList.remove('open');
            if (backdrop) {
              backdrop.classList.remove('active');
            }
          }
        });
      });

      window.addEventListener('scroll', updateActiveNav);
      window.addEventListener('resize', function() {
        // Only auto-close sidebar if we're above mobile breakpoint
        if (window.innerWidth > 900) {
          sidebar.classList.remove('open');
          if (backdrop) {
            backdrop.classList.remove('active');
          }
        }
      });

      updateActiveNav(); // Initial call
    });
  </script>
</body>
</html>

